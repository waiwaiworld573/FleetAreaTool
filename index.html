<html>
  <head>
    <meta charset="utf-8">
    <link id="cssLink" rel="stylesheet" href="style/style.css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WS0H7X957G"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WS0H7X957G');
</script>

<!--*************************************************************************** 
ファイル構成でお察しかと思いますが動けばよかろうのコピペつぎはぎコードです        
人によっては気分が悪くなるおそれがありますので読む場合はご注意ください
****************************************************************************-->
    <script type="text/javascript" language="JavaScript">
      var maxfudacount = 10;
      var defaultHenseiName = '新規編成';
      var defaultFudaName = '札';
      var defaultFudaTextColor = '#ffffff';
      var defaultFudaBackColor = '#000000';
      var dragObj; //ドラッグイベント用
      var saveDataArray = []; //localStorage用の配列
      //艦娘データベース
      const Kanshu = ["海防艦", "駆逐艦", "軽空母", "軽巡洋艦", "工作艦", "航空巡洋艦", "航空戦艦", "重巡洋艦", "重雷装巡洋艦", "巡洋戦艦", "水上機母艦", "正規空母", "戦艦", "潜水艦", "潜水空母", "潜水母艦", "装甲空母", "補給艦", "揚陸艦", "練習巡洋艦"]
      const DataTable = [
["1","31","睦月","むつき","駆逐艦","睦月型","13251",["1","254","434"]],
["2","32","如月","きさらぎ","駆逐艦","睦月型","13261",["2","255","435"]],
["6","35","長月","ながつき","駆逐艦","睦月型","13321",["6","258"]],
["7","37","三日月","みかづき","駆逐艦","睦月型","13341",["7","260"]],
["9","11","吹雪","ふぶき","駆逐艦","吹雪型","14011",["9","201","426"]],
["10","12","白雪","しらゆき","駆逐艦","吹雪型","14021",["10","202"]],
["11","14","深雪","みゆき","駆逐艦","吹雪型","14041",["11","204"]],
["12","16","磯波","いそなみ","駆逐艦","吹雪型","14091",["12","206","666"]],
["13","17","綾波","あやなみ","駆逐艦","綾波型","14111",["13","207","195"]],
["14","18","敷波","しきなみ","駆逐艦","綾波型","14121",["14","208","627"]],
["15","68","曙","あけぼの","駆逐艦","綾波型","14181",["15","231","665"]],
["16","70","潮","うしお","駆逐艦","綾波型","14201",["16","233","407"]],
["17","91","陽炎","かげろう","駆逐艦","陽炎型","16011",["17","225","566"]],
["18","92","不知火","しらぬい","駆逐艦","陽炎型","16021",["18","226","567"]],
["19","93","黒潮","くろしお","駆逐艦","陽炎型","16031",["19","227","568"]],
["20","5","雪風","ゆきかぜ","駆逐艦","陽炎型","16081",["20","228","651","656"]],
["21","42","長良","ながら","軽巡洋艦","長良型","10081",["21","218"]],
["22","43","五十鈴","いすず","軽巡洋艦","長良型","10091",["22","219","141"]],
["23","45","由良","ゆら","軽巡洋艦","長良型","10111",["23","220","488"]],
["24","19","大井","おおい","軽巡洋艦","球磨型","10061",["24","57","118"]],
["25","20","北上","きたかみ","軽巡洋艦","球磨型","10051",["25","58","119"]],
["26","26","扶桑","ふそう","戦艦","扶桑型","1051",["26","286","411"]],
["27","27","山城","やましろ","戦艦","扶桑型","1061",["27","287","412"]],
["28","33","皐月","さつき","駆逐艦","睦月型","13291",["28","256","418"]],
["29","34","文月","ふみづき","駆逐艦","睦月型","13311",["29","257","548"]],
["30","36","菊月","きくづき","駆逐艦","睦月型","13331",["30","259"]],
["31","38","望月","もちづき","駆逐艦","睦月型","13351",["31","261"]],
["32","13","初雪","はつゆき","駆逐艦","吹雪型","14031",["32","203"]],
["33","15","叢雲","むらくも","駆逐艦","吹雪型","14051",["33","205","420"]],
["34","71","暁","あかつき","駆逐艦","暁型","14211",["34","234","437"]],
["35","72","響","ひびき","駆逐艦","暁型","14221",["35","235","147"]],
["36","73","雷","いかづち","駆逐艦","暁型","14231",["36","236"]],
["37","74","電","いなづま","駆逐艦","暁型","14241",["37","237"]],
["38","75","初春","はつはる","駆逐艦","初春型","15011",["38","238","326"]],
["39","76","子日","ねのひ","駆逐艦","初春型","15021",["39","239"]],
["40","77","若葉","わかば","駆逐艦","初春型","15031",["40","240"]],
["41","78","初霜","はつしも","駆逐艦","初春型","15041",["41","241","419"]],
["42","79","白露","しらつゆ","駆逐艦","白露型","15071",["42","242","497"]],
["43","80","時雨","しぐれ","駆逐艦","白露型","15081",["43","243","145"]],
["44","81","村雨","むらさめ","駆逐艦","白露型","15091",["44","244","498"]],
["45","82","夕立","ゆうだち","駆逐艦","白露型","15101",["45","245","144"]],
["46","83","五月雨","さみだれ","駆逐艦","白露型","15121",["46","246"]],
["47","84","涼風","すずかぜ","駆逐艦","白露型","15161",["47","247"]],
["48","89","霰","あられ","駆逐艦","朝潮型","15251",["48","252","198"]],
["49","90","霞","かすみ","駆逐艦","朝潮型","15261",["49","253","464","470"]],
["50","10","島風","しまかぜ","駆逐艦","島風型","18011",["50","229"]],
["51","28","天龍","てんりゅう","軽巡洋艦","天龍型","10011",["51","213","477"]],
["52","29","龍田","たつた","軽巡洋艦","天龍型","10021",["52","214","478"]],
["53","44","名取","なとり","軽巡洋艦","長良型","10101",["53","221"]],
["54","46","川内","せんだい","軽巡洋艦","川内型","10141",["54","222","158"]],
["55","47","神通","じんつう","軽巡洋艦","川内型","10151",["55","223","159"]],
["56","48","那珂","なか","軽巡洋艦","川内型","10161",["56","224","160"]],
["57","97","大井改","おおい","重雷装巡洋艦","球磨型","10062",["24","118","57"]],
["58","98","北上改","きたかみ","重雷装巡洋艦","球磨型","10052",["25","119","58"]],
["59","52","古鷹","ふるたか","重巡洋艦","古鷹型","8011",["59","262","416"]],
["60","53","加古","かこ","重巡洋艦","古鷹型","8021",["60","263","417"]],
["61","54","青葉","あおば","重巡洋艦","青葉型","8031",["61","264"]],
["62","55","妙高","みょうこう","重巡洋艦","妙高型","8051",["62","265","319"]],
["63","56","那智","なち","重巡洋艦","妙高型","8061",["63","266","192"]],
["64","57","足柄","あしがら","重巡洋艦","妙高型","8071",["64","267","193"]],
["65","58","羽黒","はぐろ","重巡洋艦","妙高型","8081",["65","268","194"]],
["66","59","高雄","たかお","重巡洋艦","高雄型","8091",["66","269"]],
["67","60","愛宕","あたご","重巡洋艦","高雄型","8101",["67","270"]],
["68","61","摩耶","まや","重巡洋艦","高雄型","8111",["68","271","428"]],
["69","62","鳥海","ちょうかい","重巡洋艦","高雄型","8121",["69","272","427"]],
["70","51","最上","もがみ","重巡洋艦","最上型","9011",["70","73","501","506"]],
["71","63","利根","とね","重巡洋艦","利根型","9051",["71","273","188"]],
["72","64","筑摩","ちくま","重巡洋艦","利根型","9061",["72","274","189"]],
["73","101","最上改","もがみ","航空巡洋艦","最上型","9012",["70","501","73","506"]],
["74","94","祥鳳","しょうほう","軽空母","祥鳳型","4041",["74","282"]],
["75","65","飛鷹","ひよう","軽空母","飛鷹型","4061",["75","283"]],
["76","30","龍驤","りゅうじょう","軽空母","龍驤型","4021",["76","281","157"]],
["77","3","伊勢","いせ","戦艦","伊勢型","1071",["77","82","553"]],
["78","21","金剛","こんごう","巡洋戦艦","金剛型","1011",["78","209","149","591"]],
["79","23","榛名","はるな","巡洋戦艦","金剛型","1031",["79","211","151"]],
["80","1","長門","ながと","戦艦","長門型","1091",["80","275","541"]],
["81","2","陸奥","むつ","戦艦","長門型","1101",["81","276","573"]],
["82","102","伊勢改","いせ","航空戦艦","伊勢型","1072",["77","553","82"]],
["83","6","赤城","あかぎ","正規空母","赤城型","2011",["83","277","594","599"]],
["84","7","加賀","かが","正規空母","加賀型","2021",["84","278","698","610","646"]],
["85","24","霧島","きりしま","巡洋戦艦","金剛型","1041",["85","212","152"]],
["86","22","比叡","ひえい","巡洋戦艦","金剛型","1021",["86","210","150","592"]],
["87","4","日向","ひゅうが","戦艦","伊勢型","1081",["87","88","554"]],
["88","103","日向改","ひゅうが","航空戦艦","伊勢型","1082",["87","554","88"]],
["89","25","鳳翔","ほうしょう","軽空母","鳳翔型","4011",["89","285"]],
["90","8","蒼龍","そうりゅう","正規空母","蒼龍型","2031",["90","279","197"]],
["91","9","飛龍","ひりゅう","正規空母","飛龍型","2041",["91","280","196"]],
["92","66","隼鷹","じゅんよう","軽空母","飛鷹型","4071",["92","284","408"]],
["93","67","朧","おぼろ","駆逐艦","綾波型","14171",["93","230"]],
["94","69","漣","さざなみ","駆逐艦","綾波型","14191",["94","232"]],
["95","85","朝潮","あさしお","駆逐艦","朝潮型","15171",["95","248","463","468"]],
["96","86","大潮","おおしお","駆逐艦","朝潮型","15181",["96","249","199"]],
["97","87","満潮","みちしお","駆逐艦","朝潮型","15191",["97","250","489"]],
["98","88","荒潮","あらしお","駆逐艦","朝潮型","15201",["98","251","490"]],
["99","39","球磨","くま","軽巡洋艦","球磨型","10031",["99","215","652","657"]],
["100","40","多摩","たま","軽巡洋艦","球磨型","10041",["100","216","547"]],
["101","41","木曾","きそ","軽巡洋艦","球磨型","10071",["101","217","146"]],
["102","49","千歳","ちとせ","水上機母艦","千歳型","6031",["102","104","106","108","291","296"]],
["103","50","千代田","ちよだ","水上機母艦","千歳型","6041",["103","105","107","109","292","297"]],
["104","95","千歳改","ちとせ","水上機母艦","千歳型","6032",["102","106","104","108","291","296"]],
["105","96","千代田改","ちよだ","水上機母艦","千歳型","6042",["103","107","105","109","292","297"]],
["106","99","千歳甲","ちとせ","水上機母艦","千歳型","6033",["104","108","102","106","291","296"]],
["107","100","千代田甲","ちよだ","水上機母艦","千歳型","6043",["105","109","103","107","292","297"]],
["108","104","千歳航","ちとせ","軽空母","千歳型","4084",["106","291","104","108","102","296"]],
["109","105","千代田航","ちよだ","軽空母","千歳型","4094",["107","292","105","109","103","297"]],
["110","106","翔鶴","しょうかく","正規空母","翔鶴型","2051",["110","288","461","466"]],
["111","107","瑞鶴","ずいかく","正規空母","翔鶴型","2061",["111","112","462","467"]],
["112","108","瑞鶴改","ずいかく","正規空母","翔鶴型","2062",["111","462","112","467"]],
["113","109","鬼怒","きぬ","軽巡洋艦","長良型","10121",["113","289","487"]],
["114","110","阿武隈","あぶくま","軽巡洋艦","長良型","10131",["114","290","200"]],
["115","111","夕張","ゆうばり","軽巡洋艦","夕張型","10171",["115","293","622","623","624"]],
["116","112","瑞鳳","ずいほう","軽空母","祥鳳型","4051",["116","117","555","560"]],
["117","113","瑞鳳改","ずいほう","軽空母","祥鳳型","4052",["116","555","117","560"]],
["118","114","大井改二","おおい","重雷装巡洋艦","球磨型","10066",["57","118","24"]],
["119","115","北上改二","きたかみ","重雷装巡洋艦","球磨型","10056",["58","119","25"]],
["120","116","三隈","みくま","重巡洋艦","最上型","9021",["120","121"]],
["121","117","三隈改","みくま","航空巡洋艦","最上型","9022",["120","121"]],
["122","119","舞風","まいかぜ","駆逐艦","陽炎型","16181",["122","294"]],
["123","120","衣笠","きぬがさ","重巡洋艦","青葉型","8041",["123","295","142"]],
["124","124","鈴谷","すずや","重巡洋艦","最上型","9031",["124","129","503","508"]],
["125","125","熊野","くまの","重巡洋艦","最上型","9041",["125","130","504","509"]],
["126","126","伊168","い168","潜水艦","海大VI型","22211",["126","398"]],
["127","127","伊58","い58","潜水艦","巡潜乙型改二","22281",["127","399"]],
["128","128","伊8","い8","潜水艦","巡潜3型","22221",["128","400"]],
["129","129","鈴谷改","すずや","航空巡洋艦","最上型","9032",["124","503","129","508"]],
["130","130","熊野改","くまの","航空巡洋艦","最上型","9042",["125","504","130","509"]],
["131","131","大和","やまと","戦艦","大和型","1111",["131","136"]],
["132","132","秋雲","あきぐも","駆逐艦","陽炎型","16191",["132","301","648"]],
["133","133","夕雲","ゆうぐも","駆逐艦","夕雲型","16201",["133","302","542"]],
["134","134","巻雲","まきぐも","駆逐艦","夕雲型","16211",["134","303","563"]],
["135","135","長波","ながなみ","駆逐艦","夕雲型","16231",["135","304","543"]],
["136","136","大和改","やまと","戦艦","大和型","1112",["131","136"]],
["137","137","阿賀野","あがの","軽巡洋艦","阿賀野型","11011",["137","305"]],
["138","138","能代","のしろ","軽巡洋艦","阿賀野型","11021",["138","306","662"]],
["139","139","矢矧","やはぎ","軽巡洋艦","阿賀野型","11031",["139","307","663","668"]],
["140","140","酒匂","さかわ","軽巡洋艦","阿賀野型","11041",["140","314"]],
["141","141","五十鈴改二","いすず","軽巡洋艦","長良型","10096",["219","141","22"]],
["142","142","衣笠改二","きぬがさ","重巡洋艦","青葉型","8046",["295","142","123"]],
["143","143","武蔵","むさし","戦艦","大和型","1121",["143","148","546"]],
["144","144","夕立改二","ゆうだち","駆逐艦","白露型","15106",["245","144","45"]],
["145","145","時雨改二","しぐれ","駆逐艦","白露型","15086",["243","145","43"]],
["146","146","木曾改二","きそ","重雷装巡洋艦","球磨型","10076",["217","146","101"]],
["147","147","Верный","ひびき","駆逐艦","暁型","14226",["235","147","35"]],
["148","148","武蔵改","むさし","戦艦","大和型","1122",["143","546","148"]],
["149","149","金剛改二","こんごう","巡洋戦艦","金剛型","1016",["209","591","78","149"]],
["150","150","比叡改二","ひえい","巡洋戦艦","金剛型","1026",["210","592","86","150"]],
["151","151","榛名改二","はるな","巡洋戦艦","金剛型","1036",["211","151","79"]],
["152","152","霧島改二","きりしま","巡洋戦艦","金剛型","1046",["212","152","85"]],
["153","153","大鳳","たいほう","装甲空母","大鳳型","3041",["153","156"]],
["154","154","香取","かとり","練習巡洋艦","香取型","12011",["154","343"]],
["155","155","伊401","い401","潜水空母","潜特型(伊400型潜水艦)","22121",["155","403"]],
["156","156","大鳳改","たいほう","装甲空母","大鳳型","3042",["153","156"]],
["157","157","龍驤改二","りゅうじょう","軽空母","龍驤型","4026",["281","157","76"]],
["158","158","川内改二","せんだい","軽巡洋艦","川内型","10146",["222","158","54"]],
["159","159","神通改二","じんつう","軽巡洋艦","川内型","10156",["223","159","55"]],
["160","160","那珂改二","なか","軽巡洋艦","川内型","10166",["224","160","56"]],
["161","161","あきつ丸","あきつまる","揚陸艦","特種船丙型","25031",["161","166"]],
["162","162","神威","かもい","補給艦","神威型","6021",["162","499","500"]],
["163","163","まるゆ","まるゆ","潜水艦","三式潜航輸送艇","25011",["163","402"]],
["164","164","弥生","やよい","駆逐艦","睦月型","13271",["164","308"]],
["165","165","卯月","うづき","駆逐艦","睦月型","13281",["165","309"]],
["166","166","あきつ丸改","あきつまる","揚陸艦","特種船丙型","25032",["161","166"]],
["167","167","磯風","いそかぜ","駆逐艦","陽炎型","16121",["167","320","557"]],
["168","168","浦風","うらかぜ","駆逐艦","陽炎型","16111",["168","317","556"]],
["169","169","谷風","たにかぜ","駆逐艦","陽炎型","16141",["169","313","559"]],
["170","170","浜風","はまかぜ","駆逐艦","陽炎型","16131",["170","312","558"]],
["171","171","Bismarck","ビスマルク","巡洋戦艦","Bismarck級","30011",["171","172","173","178"]],
["172","172","Bismarck改","ビスマルク","巡洋戦艦","Bismarck級","30012",["171","173","172","178"]],
["173","173","Bismarck zwei","ビスマルク","巡洋戦艦","Bismarck級","30016",["172","178","171","173"]],
["174","174","Z1","レーベレヒト・マース","駆逐艦","Z1型","30511",["174","310","179"]],
["175","175","Z3","マックス・シュルツ","駆逐艦","Z1型","30521",["175","311","180"]],
["176","176","Prinz Eugen","プリンツ・オイゲン","重巡洋艦","Admiral Hipper級","30311",["176","177"]],
["177","177","Prinz Eugen改","プリンツ・オイゲン","重巡洋艦","Admiral Hipper級","30312",["176","177"]],
["178","178","Bismarck drei","ビスマルク","巡洋戦艦","Bismarck級","30019",["173","178","172","171"]],
["179","179","Z1 zwei","レーベレヒト・マース","駆逐艦","Z1型","30516",["310","179","174"]],
["180","180","Z3 zwei","マックス・シュルツ","駆逐艦","Z1型","30526",["311","180","175"]],
["181","181","天津風","あまつかぜ","駆逐艦","陽炎型","16091",["181","316"]],
["182","182","明石","あかし","工作艦","工作艦","7211",["182","187"]],
["183","183","大淀","おおよど","軽巡洋艦","大淀型","11051",["183","321"]],
["184","184","大鯨","たいげい・りゅうほう","潜水母艦","大鯨型","7051",["184","185","318","883","888"]],
["185","185","龍鳳","たいげい・りゅうほう","軽空母","龍鳳型","4031",["184","318","185","883","888"]],
["186","186","時津風","ときつかぜ","駆逐艦","陽炎型","16101",["186","322"]],
["187","187","明石改","あかし","工作艦","工作艦","7212",["182","187"]],
["188","188","利根改二","とね","航空巡洋艦","利根型","9056",["273","188","71"]],
["189","189","筑摩改二","ちくま","航空巡洋艦","利根型","9066",["274","189","72"]],
["190","118","初風","はつかぜ","駆逐艦","陽炎型","16071",["190","300"]],
["191","123","伊19","い19","潜水艦","巡潜乙型","22231",["191","401"]],
["192","192","那智改二","なち","重巡洋艦","妙高型","8066",["266","192","63"]],
["193","193","足柄改二","あしがら","重巡洋艦","妙高型","8076",["267","193","64"]],
["194","194","羽黒改二","はぐろ","重巡洋艦","妙高型","8086",["268","194","65"]],
["195","195","綾波改二","あやなみ","駆逐艦","綾波型","14116",["207","195","13"]],
["196","196","飛龍改二","ひりゅう","正規空母","飛龍型","2046",["280","196","91"]],
["197","197","蒼龍改二","そうりゅう","正規空母","蒼龍型","2036",["279","197","90"]],
["198","198","霰改二","あられ","駆逐艦","朝潮型","15256",["252","198","48"]],
["199","199","大潮改二","おおしお","駆逐艦","朝潮型","15186",["249","199","96"]],
["200","200","阿武隈改二","あぶくま","軽巡洋艦","長良型","10136",["290","200","114"]],
["201","1301","吹雪改","ふぶき","駆逐艦","吹雪型","14012",["9","426","201"]],
["202","1302","白雪改","しらゆき","駆逐艦","吹雪型","14022",["10","202"]],
["203","1303","初雪改","はつゆき","駆逐艦","吹雪型","14032",["32","203"]],
["204","1304","深雪改","みゆき","駆逐艦","吹雪型","14042",["11","204"]],
["205","1305","叢雲改","むらくも","駆逐艦","吹雪型","14052",["33","420","205"]],
["206","1306","磯波改","いそなみ","駆逐艦","吹雪型","14092",["12","666","206"]],
["207","1307","綾波改","あやなみ","駆逐艦","綾波型","14112",["13","195","207"]],
["208","1308","敷波改","しきなみ","駆逐艦","綾波型","14122",["14","627","208"]],
["209","1309","金剛改","こんごう","巡洋戦艦","金剛型","1012",["78","149","209","591"]],
["210","1310","比叡改","ひえい","巡洋戦艦","金剛型","1022",["86","150","210","592"]],
["211","1311","榛名改","はるな","巡洋戦艦","金剛型","1032",["79","151","211"]],
["212","1312","霧島改","きりしま","巡洋戦艦","金剛型","1042",["85","152","212"]],
["213","1313","天龍改","てんりゅう","軽巡洋艦","天龍型","10012",["51","477","213"]],
["214","1314","龍田改","たつた","軽巡洋艦","天龍型","10022",["52","478","214"]],
["215","1315","球磨改","くま","軽巡洋艦","球磨型","10032",["99","652","215","657"]],
["216","1316","多摩改","たま","軽巡洋艦","球磨型","10042",["100","547","216"]],
["217","1317","木曾改","きそ","軽巡洋艦","球磨型","10072",["101","146","217"]],
["218","1318","長良改","ながら","軽巡洋艦","長良型","10082",["21","218"]],
["219","1319","五十鈴改","いすず","軽巡洋艦","長良型","10092",["22","141","219"]],
["220","1320","由良改","ゆら","軽巡洋艦","長良型","10112",["23","488","220"]],
["221","1321","名取改","なとり","軽巡洋艦","長良型","10102",["53","221"]],
["222","1322","川内改","せんだい","軽巡洋艦","川内型","10142",["54","158","222"]],
["223","1323","神通改","じんつう","軽巡洋艦","川内型","10152",["55","159","223"]],
["224","1324","那珂改","なか","軽巡洋艦","川内型","10162",["56","160","224"]],
["225","1325","陽炎改","かげろう","駆逐艦","陽炎型","16012",["17","566","225"]],
["226","1326","不知火改","しらぬい","駆逐艦","陽炎型","16022",["18","567","226"]],
["227","1327","黒潮改","くろしお","駆逐艦","陽炎型","16032",["19","568","227"]],
["228","1328","雪風改","ゆきかぜ","駆逐艦","陽炎型","16082",["20","651","228","656"]],
["229","1329","島風改","しまかぜ","駆逐艦","島風型","18012",["50","229"]],
["230","1330","朧改","おぼろ","駆逐艦","綾波型","14172",["93","230"]],
["231","1331","曙改","あけぼの","駆逐艦","綾波型","14182",["15","665","231"]],
["232","1332","漣改","さざなみ","駆逐艦","綾波型","14192",["94","232"]],
["233","1333","潮改","うしお","駆逐艦","綾波型","14202",["16","407","233"]],
["234","1334","暁改","あかつき","駆逐艦","暁型","14212",["34","437","234"]],
["235","1335","響改","ひびき","駆逐艦","暁型","14222",["35","147","235"]],
["236","1336","雷改","いかづち","駆逐艦","暁型","14232",["36","236"]],
["237","1337","電改","いなづま","駆逐艦","暁型","14242",["37","237"]],
["238","1338","初春改","はつはる","駆逐艦","初春型","15012",["38","326","238"]],
["239","1339","子日改","ねのひ","駆逐艦","初春型","15022",["39","239"]],
["240","1340","若葉改","わかば","駆逐艦","初春型","15032",["40","240"]],
["241","1341","初霜改","はつしも","駆逐艦","初春型","15042",["41","419","241"]],
["242","1342","白露改","しらつゆ","駆逐艦","白露型","15072",["42","497","242"]],
["243","1343","時雨改","しぐれ","駆逐艦","白露型","15082",["43","145","243"]],
["244","1344","村雨改","むらさめ","駆逐艦","白露型","15092",["44","498","244"]],
["245","1345","夕立改","ゆうだち","駆逐艦","白露型","15102",["45","144","245"]],
["246","1346","五月雨改","さみだれ","駆逐艦","白露型","15122",["46","246"]],
["247","1347","涼風改","すずかぜ","駆逐艦","白露型","15162",["47","247"]],
["248","1348","朝潮改","あさしお","駆逐艦","朝潮型","15172",["95","463","248","468"]],
["249","1349","大潮改","おおしお","駆逐艦","朝潮型","15182",["96","199","249"]],
["250","1350","満潮改","みちしお","駆逐艦","朝潮型","15192",["97","489","250"]],
["251","1351","荒潮改","あらしお","駆逐艦","朝潮型","15202",["98","490","251"]],
["252","1352","霰改","あられ","駆逐艦","朝潮型","15252",["48","198","252"]],
["253","1353","霞改","かすみ","駆逐艦","朝潮型","15262",["49","464","253","470"]],
["254","1354","睦月改","むつき","駆逐艦","睦月型","13252",["1","434","254"]],
["255","1355","如月改","きさらぎ","駆逐艦","睦月型","13262",["2","435","255"]],
["256","1356","皐月改","さつき","駆逐艦","睦月型","13292",["28","418","256"]],
["257","1357","文月改","ふみづき","駆逐艦","睦月型","13312",["29","548","257"]],
["258","1358","長月改","ながつき","駆逐艦","睦月型","13322",["6","258"]],
["259","1359","菊月改","きくづき","駆逐艦","睦月型","13332",["30","259"]],
["260","1360","三日月改","みかづき","駆逐艦","睦月型","13342",["7","260"]],
["261","1361","望月改","もちづき","駆逐艦","睦月型","13352",["31","261"]],
["262","1362","古鷹改","ふるたか","重巡洋艦","古鷹型","8012",["59","416","262"]],
["263","1363","加古改","かこ","重巡洋艦","古鷹型","8022",["60","417","263"]],
["264","1364","青葉改","あおば","重巡洋艦","青葉型","8032",["61","264"]],
["265","1365","妙高改","みょうこう","重巡洋艦","妙高型","8052",["62","319","265"]],
["266","1366","那智改","なち","重巡洋艦","妙高型","8062",["63","192","266"]],
["267","1367","足柄改","あしがら","重巡洋艦","妙高型","8072",["64","193","267"]],
["268","1368","羽黒改","はぐろ","重巡洋艦","妙高型","8082",["65","194","268"]],
["269","1369","高雄改","たかお","重巡洋艦","高雄型","8092",["66","269"]],
["270","1370","愛宕改","あたご","重巡洋艦","高雄型","8102",["67","270"]],
["271","1371","摩耶改","まや","重巡洋艦","高雄型","8112",["68","428","271"]],
["272","1372","鳥海改","ちょうかい","重巡洋艦","高雄型","8122",["69","427","272"]],
["273","1373","利根改","とね","重巡洋艦","利根型","9052",["71","188","273"]],
["274","1374","筑摩改","ちくま","重巡洋艦","利根型","9062",["72","189","274"]],
["275","1375","長門改","ながと","戦艦","長門型","1092",["80","541","275"]],
["276","1376","陸奥改","むつ","戦艦","長門型","1102",["81","573","276"]],
["277","1377","赤城改","あかぎ","正規空母","赤城型","2012",["83","594","277","599"]],
["278","1378","加賀改","かが","正規空母","加賀型","2022",["84","698","278","610","646"]],
["279","1379","蒼龍改","そうりゅう","正規空母","蒼龍型","2032",["90","197","279"]],
["280","1380","飛龍改","ひりゅう","正規空母","飛龍型","2042",["91","196","280"]],
["281","1381","龍驤改","りゅうじょう","軽空母","龍驤型","4022",["76","157","281"]],
["282","1382","祥鳳改","しょうほう","軽空母","祥鳳型","4042",["74","282"]],
["283","1383","飛鷹改","ひよう","軽空母","飛鷹型","4062",["75","283"]],
["284","1384","隼鷹改","じゅんよう","軽空母","飛鷹型","4072",["92","408","284"]],
["285","1385","鳳翔改","ほうしょう","軽空母","鳳翔型","4012",["89","285"]],
["286","1386","扶桑改","ふそう","航空戦艦","扶桑型","1052",["26","411","286"]],
["287","1387","山城改","やましろ","航空戦艦","扶桑型","1062",["27","412","287"]],
["288","1388","翔鶴改","しょうかく","正規空母","翔鶴型","2052",["110","461","288","466"]],
["289","1389","鬼怒改","きぬ","軽巡洋艦","長良型","10122",["113","487","289"]],
["290","1390","阿武隈改","あぶくま","軽巡洋艦","長良型","10132",["114","200","290"]],
["291","1391","千歳航改","ちとせ","軽空母","千歳型","4085",["108","296","106","291","104","102"]],
["292","1392","千代田航改","ちよだ","軽空母","千歳型","4095",["109","297","107","292","105","103"]],
["293","1393","夕張改","ゆうばり","軽巡洋艦","夕張型","10172",["115","622","293","623","624"]],
["294","1394","舞風改","まいかぜ","駆逐艦","陽炎型","16182",["122","294"]],
["295","1395","衣笠改","きぬがさ","重巡洋艦","青葉型","8042",["123","142","295"]],
["296","121","千歳航改二","ちとせ","軽空母","千歳型","4086",["291","296","108","106","104","102"]],
["297","122","千代田航改二","ちよだ","軽空母","千歳型","4096",["292","297","109","107","105","103"]],
["299","493","Scamp","スキャンプ","潜水艦","不明","32731",["299","715"]],
["300","1396","初風改","はつかぜ","駆逐艦","陽炎型","16072",["190","300"]],
["301","1397","秋雲改","あきぐも","駆逐艦","陽炎型","16192",["132","648","301"]],
["302","1398","夕雲改","ゆうぐも","駆逐艦","夕雲型","16202",["133","542","302"]],
["303","1399","巻雲改","まきぐも","駆逐艦","夕雲型","16212",["134","563","303"]],
["304","1400","長波改","ながなみ","駆逐艦","夕雲型","16232",["135","543","304"]],
["305","1401","阿賀野改","あがの","軽巡洋艦","阿賀野型","11012",["137","305"]],
["306","1402","能代改","のしろ","軽巡洋艦","阿賀野型","11022",["138","662","306"]],
["307","1403","矢矧改","やはぎ","軽巡洋艦","阿賀野型","11032",["139","663","307","668"]],
["308","1404","弥生改","やよい","駆逐艦","睦月型","13272",["164","308"]],
["309","1405","卯月改","うづき","駆逐艦","睦月型","13282",["165","309"]],
["310","1406","Z1改","レーベレヒト・マース","駆逐艦","Z1型","30512",["174","179","310"]],
["311","1407","Z3改","マックス・シュルツ","駆逐艦","Z1型","30522",["175","180","311"]],
["312","1408","浜風改","はまかぜ","駆逐艦","陽炎型","16132",["170","558","312"]],
["313","1409","谷風改","たにかぜ","駆逐艦","陽炎型","16142",["169","559","313"]],
["314","1410","酒匂改","さかわ","軽巡洋艦","阿賀野型","11042",["140","314"]],
["316","1411","天津風改","あまつかぜ","駆逐艦","陽炎型","16092",["181","316"]],
["317","1412","浦風改","うらかぜ","駆逐艦","陽炎型","16112",["168","556","317"]],
["318","190","龍鳳改","たいげい・りゅうほう","軽空母","龍鳳型","4032",["185","883","184","318","888"]],
["319","191","妙高改二","みょうこう","重巡洋艦","妙高型","8056",["265","319","62"]],
["320","1413","磯風改","いそかぜ","駆逐艦","陽炎型","16122",["167","557","320"]],
["321","1414","大淀改","おおよど","軽巡洋艦","大淀型","11052",["183","321"]],
["322","1415","時津風改","ときつかぜ","駆逐艦","陽炎型","16102",["186","322"]],
["323","1416","春雨改","はるさめ","駆逐艦","白露型","15112",["405","323"]],
["324","1417","早霜改","はやしも","駆逐艦","夕雲型","16362",["409","324"]],
["325","1418","清霜改","きよしも","駆逐艦","夕雲型","16382",["410","325"]],
["326","204","初春改二","はつはる","駆逐艦","初春型","15016",["238","326","38"]],
["327","1419","朝雲改","あさぐも","駆逐艦","朝潮型","15212",["413","327"]],
["328","1420","山雲改","やまぐも","駆逐艦","朝潮型","15222",["414","328"]],
["329","1421","野分改","のわき","駆逐艦","陽炎型","16152",["415","329"]],
["330","1422","秋月改","あきづき","駆逐艦","秋月型","17012",["421","330"]],
["331","202","天城","あまぎ","正規空母","雲龍型","3021",["331","429"]],
["332","203","葛城","かつらぎ","正規空母","雲龍型","3031",["332","430"]],
["334","1504","U-511改","ゆー511・ろ500","潜水艦","UボートIXC型","23012",["431","436","334"]],
["343","1423","香取改","かとり","練習巡洋艦","香取型","12012",["154","343"]],
["344","1424","朝霜改","あさしも","駆逐艦","夕雲型","16352",["425","578","344"]],
["345","1425","高波改","たかなみ","駆逐艦","夕雲型","16252",["424","649","345"]],
["346","1426","照月改","てるづき","駆逐艦","秋月型","17022",["422","346"]],
["347","1427","Libeccio改","リベッチオ","駆逐艦","Maestrale級","31532",["443","347"]],
["348","1428","瑞穂改","みずほ","水上機母艦","瑞穂型","6052",["451","348"]],
["349","1429","風雲改","かざぐも","駆逐艦","夕雲型","16222",["453","564","349"]],
["350","1430","海風改","うみかぜ","駆逐艦","白露型","15132",["458","587","350"]],
["351","1431","江風改","かわかぜ","駆逐艦","白露型","15152",["459","469","351"]],
["352","1432","速吸改","はやすい","補給艦","改風早型","7112",["460","352"]],
["353","1433","Graf Zeppelin改","グラーフ・ツェッペリン","正規空母","Graf Zeppelin級","30112",["432","353"]],
["354","1434","嵐改","あらし","駆逐艦","陽炎型","16162",["454","354"]],
["355","1435","萩風改","はぎかぜ","駆逐艦","陽炎型","16172",["455","355"]],
["356","1436","鹿島改","かしま","練習巡洋艦","香取型","12022",["465","356"]],
["357","1437","初月改","はつづき","駆逐艦","秋月型","17042",["423","357"]],
["358","1438","Zara改","ザラ","重巡洋艦","Zara級","31312",["448","496","358"]],
["359","1439","沖波改","おきなみ","駆逐艦","夕雲型","16332",["452","569","359"]],
["360","1440","Iowa改","アイオワ","巡洋戦艦","Iowa級","32092",["440","360"]],
["361","1441","Pola改","ポーラ","重巡洋艦","Zara級","31322",["449","361"]],
["362","1442","親潮改","おやしお","駆逐艦","陽炎型","16042",["456","670","362"]],
["363","1443","春風改","はるかぜ","駆逐艦","神風型","13182",["473","363"]],
["364","1444","Warspite改","ウォースパイト","戦艦","Queen Elizabeth級","33012",["439","364"]],
["365","1445","Aquila改","アクィラ","正規空母","Aquila級","31112",["444","365"]],
["366","1446","水無月改","みなづき","駆逐艦","睦月型","13302",["481","366"]],
["367","1447","伊26改","い26","潜水空母","巡潜乙型","22242",["483","367"]],
["368","1448","浦波改","うらなみ","駆逐艦","吹雪型","14102",["486","647","368"]],
["369","1449","山風改","やまかぜ","駆逐艦","白露型","15142",["457","588","369","667"]],
["370","1450","朝風改","あさかぜ","駆逐艦","神風型","13172",["472","370"]],
["371","1451","松風改","まつかぜ","駆逐艦","神風型","13192",["474","371"]],
["372","1452","Commandant Teste改","コマンダン・テスト","水上機母艦","C.Teste級","34212",["491","372"]],
["373","1453","藤波改","ふじなみ","駆逐艦","夕雲型","16302",["485","373"]],
["374","1454","伊13改","い13","潜水空母","巡潜甲型改二","22012",["494","374"]],
["375","1455","伊14改","い14","潜水空母","巡潜甲型改二","22022",["495","375"]],
["376","1456","占守改","しむしゅ","海防艦","占守型","20012",["517","376"]],
["377","1457","国後改","くなしり","海防艦","占守型","20022",["518","377"]],
["378","1458","八丈改","はちじょう","海防艦","占守型","20032",["584","378"]],
["379","1459","石垣改","いしがき","海防艦","占守型","20042",["585","379"]],
["380","1460","大鷹改","たいよう","軽空母","大鷹型","5013",["526","529","521","380"]],
["381","1461","神鷹改","しんよう","軽空母","大鷹型","5042",["534","536","381"]],
["382","1462","雲鷹改","うんよう","軽空母","大鷹型","5023",["884","889","522","382"]],
["383","1463","択捉改","えとろふ","海防艦","択捉型","20052",["524","383"]],
["384","1464","松輪改","まつわ","海防艦","択捉型","20062",["525","384"]],
["385","1465","佐渡改","さど","海防艦","択捉型","20072",["531","385"]],
["386","1466","対馬改","つしま","海防艦","択捉型","20112",["540","386"]],
["387","1467","旗風改","はたかぜ","駆逐艦","神風型","13202",["475","387"]],
["390","1470","天霧改","あまぎり","駆逐艦","綾波型","14152",["479","903","390","908"]],
["391","1471","狭霧改","さぎり","駆逐艦","綾波型","14162",["480","391"]],
["392","1472","Richelieu改","リシュリュー","巡洋戦艦","Richelieu級","34012",["492","392"]],
["393","1473","Ark Royal改","アークロイヤル","正規空母","Ark Royal級","33112",["515","393"]],
["394","1474","Jervis改","ジャーヴィス","駆逐艦","J級","33512",["519","394"]],
["395","1475","Ташкент改","タシュケント","駆逐艦","Ташкент級","35512",["516","395"]],
["396","1476","Gambier Bay改","ガンビア・ベイ","軽空母","Casablanca級","32132",["544","707","396"]],
["397","1477","Intrepid改","イントレピッド","正規空母","Essex級","32122",["549","397"]],
["398","1498","伊168改","い168","潜水艦","海大VI型","22212",["126","398"]],
["399","1499","伊58改","い58","潜水空母","巡潜乙型改二","22282",["127","399"]],
["400","1500","伊8改","い8","潜水空母","巡潜3型","22222",["128","400"]],
["401","1501","伊19改","い19","潜水空母","巡潜乙型","22232",["191","401"]],
["402","1502","まるゆ改","まるゆ","潜水艦","三式潜航輸送艇","25012",["163","402"]],
["403","1503","伊401改","い401","潜水空母","潜特型(伊400型潜水艦)","22122",["155","403"]],
["404","201","雲龍","うんりゅう","正規空母","雲龍型","3011",["404","406"]],
["405","205","春雨","はるさめ","駆逐艦","白露型","15111",["405","323"]],
["406","206","雲龍改","うんりゅう","正規空母","雲龍型","3012",["404","406"]],
["407","207","潮改二","うしお","駆逐艦","綾波型","14206",["233","407","16"]],
["408","208","隼鷹改二","じゅんよう","軽空母","飛鷹型","4076",["284","408","92"]],
["409","209","早霜","はやしも","駆逐艦","夕雲型","16361",["409","324"]],
["410","210","清霜","きよしも","駆逐艦","夕雲型","16381",["410","325"]],
["411","211","扶桑改二","ふそう","航空戦艦","扶桑型","1056",["286","411","26"]],
["412","212","山城改二","やましろ","航空戦艦","扶桑型","1066",["287","412","27"]],
["413","213","朝雲","あさぐも","駆逐艦","朝潮型","15211",["413","327"]],
["414","214","山雲","やまぐも","駆逐艦","朝潮型","15221",["414","328"]],
["415","215","野分","のわき","駆逐艦","陽炎型","16151",["415","329"]],
["416","216","古鷹改二","ふるたか","重巡洋艦","古鷹型","8016",["262","416","59"]],
["417","217","加古改二","かこ","重巡洋艦","古鷹型","8026",["263","417","60"]],
["418","218","皐月改二","さつき","駆逐艦","睦月型","13296",["256","418","28"]],
["419","219","初霜改二","はつしも","駆逐艦","初春型","15046",["241","419","41"]],
["420","220","叢雲改二","むらくも","駆逐艦","吹雪型","14056",["205","420","33"]],
["421","221","秋月","あきづき","駆逐艦","秋月型","17011",["421","330"]],
["422","222","照月","てるづき","駆逐艦","秋月型","17021",["422","346"]],
["423","223","初月","はつづき","駆逐艦","秋月型","17041",["423","357"]],
["424","224","高波","たかなみ","駆逐艦","夕雲型","16251",["424","345","649"]],
["425","225","朝霜","あさしも","駆逐艦","夕雲型","16351",["425","344","578"]],
["426","226","吹雪改二","ふぶき","駆逐艦","吹雪型","14016",["201","426","9"]],
["427","227","鳥海改二","ちょうかい","重巡洋艦","高雄型","8126",["272","427","69"]],
["428","228","摩耶改二","まや","重巡洋艦","高雄型","8116",["271","428","68"]],
["429","229","天城改","あまぎ","正規空母","雲龍型","3022",["331","429"]],
["430","230","葛城改","かつらぎ","正規空母","雲龍型","3032",["332","430"]],
["431","231","U-511","ゆー511・ろ500","潜水艦","UボートIXC型","30711",["431","334","436"]],
["432","232","Graf Zeppelin","グラーフ・ツェッペリン","正規空母","Graf Zeppelin級","30111",["432","353"]],
["433","233","Saratoga","サラトガ","正規空母","Lexington級","32111",["433","438","545","550"]],
["434","234","睦月改二","むつき","駆逐艦","睦月型","13256",["254","434","1"]],
["435","235","如月改二","きさらぎ","駆逐艦","睦月型","13266",["255","435","2"]],
["436","236","呂500","ゆー511・ろ500","潜水艦","呂号潜水艦","23021",["334","436","431"]],
["437","237","暁改二","あかつき","駆逐艦","暁型","14216",["234","437","34"]],
["438","238","Saratoga改","サラトガ","正規空母","Lexington級","32112",["433","545","438","550"]],
["439","239","Warspite","ウォースパイト","戦艦","Queen Elizabeth級","33011",["439","364"]],
["440","240","Iowa","アイオワ","巡洋戦艦","Iowa級","32091",["440","360"]],
["441","241","Littorio","リットリオ・イタリア","巡洋戦艦","V.Veneto級","31051",["441","446"]],
["442","242","Roma","ローマ","巡洋戦艦","V.Veneto級","31071",["442","447"]],
["443","243","Libeccio","リベッチオ","駆逐艦","Maestrale級","31531",["443","347"]],
["444","244","Aquila","アクィラ","正規空母","Aquila級","31111",["444","365"]],
["445","245","秋津洲","あきつしま","水上機母艦","秋津洲型","6071",["445","450"]],
["446","246","Italia","リットリオ・イタリア","巡洋戦艦","V.Veneto級","31052",["441","446"]],
["447","247","Roma改","ローマ","巡洋戦艦","V.Veneto級","31072",["442","447"]],
["448","248","Zara","ザラ","重巡洋艦","Zara級","31311",["448","358","496"]],
["449","249","Pola","ポーラ","重巡洋艦","Zara級","31321",["449","361"]],
["450","250","秋津洲改","あきつしま","水上機母艦","秋津洲型","6072",["445","450"]],
["451","251","瑞穂","みずほ","水上機母艦","瑞穂型","6051",["451","348"]],
["452","252","沖波","おきなみ","駆逐艦","夕雲型","16331",["452","359","569"]],
["453","253","風雲","かざぐも","駆逐艦","夕雲型","16221",["453","349","564"]],
["454","254","嵐","あらし","駆逐艦","陽炎型","16161",["454","354"]],
["455","255","萩風","はぎかぜ","駆逐艦","陽炎型","16171",["455","355"]],
["456","256","親潮","おやしお","駆逐艦","陽炎型","16041",["456","362","670"]],
["457","257","山風","やまかぜ","駆逐艦","白露型","15141",["457","369","588","667"]],
["458","258","海風","うみかぜ","駆逐艦","白露型","15131",["458","350","587"]],
["459","259","江風","かわかぜ","駆逐艦","白露型","15151",["459","351","469"]],
["460","260","速吸","はやすい","補給艦","改風早型","7111",["460","352"]],
["461","261","翔鶴改二","しょうかく","正規空母","翔鶴型","2056",["288","466","110","461"]],
["462","262","瑞鶴改二","ずいかく","正規空母","翔鶴型","2066",["112","467","111","462"]],
["463","263","朝潮改二","あさしお","駆逐艦","朝潮型","15176",["248","468","95","463"]],
["464","264","霞改二","かすみ","駆逐艦","朝潮型","15266",["253","470","49","464"]],
["465","265","鹿島","かしま","練習巡洋艦","香取型","12021",["465","356"]],
["466","266","翔鶴改二甲","しょうかく","装甲空母","翔鶴型","2057",["461","288","466","110"]],
["467","267","瑞鶴改二甲","ずいかく","装甲空母","翔鶴型","2067",["462","112","467","111"]],
["468","268","朝潮改二丁","あさしお","駆逐艦","朝潮型","15177",["463","248","468","95"]],
["469","269","江風改二","かわかぜ","駆逐艦","白露型","15156",["351","469","459"]],
["470","270","霞改二乙","かすみ","駆逐艦","朝潮型","15267",["464","253","470","49"]],
["471","271","神風","かみかぜ","駆逐艦","神風型","13161",["471","476"]],
["472","272","朝風","あさかぜ","駆逐艦","神風型","13171",["472","370"]],
["473","273","春風","はるかぜ","駆逐艦","神風型","13181",["473","363"]],
["474","274","松風","まつかぜ","駆逐艦","神風型","13191",["474","371"]],
["475","275","旗風","はたかぜ","駆逐艦","神風型","13201",["475","387"]],
["476","276","神風改","かみかぜ","駆逐艦","神風型","13162",["471","476"]],
["477","277","天龍改二","てんりゅう","軽巡洋艦","天龍型","10016",["213","477","51"]],
["478","278","龍田改二","たつた","軽巡洋艦","天龍型","10026",["214","478","52"]],
["479","279","天霧","あまぎり","駆逐艦","綾波型","14151",["479","390","903","908"]],
["480","280","狭霧","さぎり","駆逐艦","綾波型","14161",["480","391"]],
["481","281","水無月","みなづき","駆逐艦","睦月型","13301",["481","366"]],
["483","283","伊26","い26","潜水艦","巡潜乙型","22241",["483","367"]],
["484","284","浜波","はまなみ","駆逐艦","夕雲型","16321",["484","680"]],
["485","285","藤波","ふじなみ","駆逐艦","夕雲型","16301",["485","373"]],
["486","286","浦波","うらなみ","駆逐艦","吹雪型","14101",["486","368","647"]],
["487","287","鬼怒改二","きぬ","軽巡洋艦","長良型","10126",["289","487","113"]],
["488","288","由良改二","ゆら","軽巡洋艦","長良型","10116",["220","488","23"]],
["489","289","満潮改二","みちしお","駆逐艦","朝潮型","15196",["250","489","97"]],
["490","290","荒潮改二","あらしお","駆逐艦","朝潮型","15206",["251","490","98"]],
["491","291","Commandant Teste","コマンダン・テスト","水上機母艦","C.Teste級","34211",["491","372"]],
["492","292","Richelieu","リシュリュー","巡洋戦艦","Richelieu級","34011",["492","392"]],
["493","293","伊400","い400","潜水空母","潜特型(伊400型潜水艦)","22111",["493","606"]],
["494","294","伊13","い13","潜水空母","巡潜甲型改二","22011",["494","374"]],
["495","295","伊14","い14","潜水空母","巡潜甲型改二","22021",["495","375"]],
["496","296","Zara due","ザラ","重巡洋艦","Zara級","31316",["358","496","448"]],
["497","297","白露改二","しらつゆ","駆逐艦","白露型","15076",["242","497","42"]],
["498","298","村雨改二","むらさめ","駆逐艦","白露型","15096",["244","498","44"]],
["499","299","神威改","かもい","水上機母艦","神威型","6022",["162","500","499"]],
["500","300","神威改母","かもい","補給艦","神威型","6023",["499","500","162"]],
["501","301","最上改二","もがみ","航空巡洋艦","最上型","9016",["73","506","70","501"]],
["503","303","鈴谷改二","すずや","航空巡洋艦","最上型","9036",["129","508","124","503"]],
["504","304","熊野改二","くまの","航空巡洋艦","最上型","9046",["130","509","125","504"]],
["506","306","最上改二特","もがみ","航空巡洋艦","最上型","9017",["501","73","506","70"]],
["508","308","鈴谷航改二","すずや","軽空母","最上型","9037",["503","129","508","124"]],
["509","309","熊野航改二","くまの","軽空母","最上型","9047",["504","130","509","125"]],
["511","311","Гангут","ガングート","巡洋戦艦","Гангут級","35011",["511","512","513"]],
["512","312","Октябрьская революция","ガングート","巡洋戦艦","Гангут級","35012",["511","513","512"]],
["513","316","Гангут два","ガングート","巡洋戦艦","Гангут級","35016",["512","513","511"]],
["514","314","Sheffield","シェフィールド","軽巡洋艦","不明","33431",["514","705"]],
["515","315","Ark Royal","アークロイヤル","正規空母","Ark Royal級","33111",["515","393"]],
["516","313","Ташкент","タシュケント","駆逐艦","Ташкент級","35511",["516","395"]],
["517","317","占守","しむしゅ","海防艦","占守型","20011",["517","376"]],
["518","318","国後","くなしり","海防艦","占守型","20021",["518","377"]],
["519","319","Jervis","ジャーヴィス","駆逐艦","J級","33511",["519","394"]],
["520","320","Janus","ジェーナス","駆逐艦","J級","33521",["520","893"]],
["521","321","春日丸","たいよう","軽空母","春日丸級","5011",["521","526","380","529"]],
["522","322","八幡丸","うんよう","軽空母","春日丸級","5021",["522","884","382","889"]],
["524","334","択捉","えとろふ","海防艦","択捉型","20051",["524","383"]],
["525","335","松輪","まつわ","海防艦","択捉型","20061",["525","384"]],
["526","326","大鷹","たいよう","軽空母","大鷹型","5012",["521","380","526","529"]],
["527","327","岸波","きしなみ","駆逐艦","夕雲型","16341",["527","686"]],
["528","328","早波","はやなみ","駆逐艦","夕雲型","16311",["528","688"]],
["529","331","大鷹改二","たいよう","軽空母","大鷹型","5016",["380","529","526","521"]],
["530","330","伊504","ルイージ・トレッリ","潜水艦","Guglielmo Marconi級","22311",["539","530","605","535"]],
["531","339","佐渡","さど","海防艦","択捉型","20071",["531","385"]],
["532","332","涼月","すずつき","駆逐艦","秋月型","17031",["532","537"]],
["533","333","冬月","ふゆつき","駆逐艦","秋月型","17081",["533","538"]],
["534","324","神鷹","しんよう","軽空母","大鷹型","5041",["534","381","536"]],
["535","325","Luigi Torelli","ルイージ・トレッリ","潜水艦","Guglielmo Marconi級","31711",["535","605","539","530"]],
["536","336","神鷹改二","しんよう","軽空母","大鷹型","5046",["381","536","534"]],
["537","337","涼月改","すずつき","駆逐艦","秋月型","17032",["532","537"]],
["538","338","冬月改","ふゆつき","駆逐艦","秋月型","17082",["533","538"]],
["539","329","UIT-25","ルイージ・トレッリ","潜水艦","Guglielmo Marconi級","30721",["605","530","535","539"]],
["540","340","対馬","つしま","海防艦","択捉型","20111",["540","386"]],
["541","341","長門改二","ながと","戦艦","長門型","1096",["275","541","80"]],
["542","342","夕雲改二","ゆうぐも","駆逐艦","夕雲型","16206",["302","542","133"]],
["543","343","長波改二","ながなみ","駆逐艦","夕雲型","16236",["304","543","135"]],
["544","344","Gambier Bay","ガンビア・ベイ","軽空母","Casablanca級","32131",["544","396","707"]],
["545","345","Saratoga Mk.II","サラトガ","正規空母","Lexington級","32116",["438","550","433","545"]],
["546","346","武蔵改二","むさし","戦艦","大和型","1126",["148","546","143"]],
["547","347","多摩改二","たま","軽巡洋艦","球磨型","10046",["216","547","100"]],
["548","348","文月改二","ふみづき","駆逐艦","睦月型","13316",["257","548","29"]],
["549","349","Intrepid","イントレピッド","正規空母","Essex級","32121",["549","397"]],
["550","350","Saratoga Mk.II Mod.2","サラトガ","装甲空母","Lexington級","32117",["545","438","550","433"]],
["551","351","日振","ひぶり","海防艦","日振型","21091",["551","678"]],
["552","352","大東","だいとう","海防艦","日振型","21101",["552","679"]],
["553","353","伊勢改二","いせ","航空戦艦","伊勢型","1076",["82","553","77"]],
["554","354","日向改二","ひゅうが","航空戦艦","伊勢型","1086",["88","554","87"]],
["555","355","瑞鳳改二","ずいほう","軽空母","祥鳳型","4056",["117","560","116","555"]],
["556","356","浦風丁改","うらかぜ","駆逐艦","陽炎型","16113",["317","556","168"]],
["557","357","磯風乙改","いそかぜ","駆逐艦","陽炎型","16123",["320","557","167"]],
["558","358","浜風乙改","はまかぜ","駆逐艦","陽炎型","16133",["312","558","170"]],
["559","359","谷風丁改","たにかぜ","駆逐艦","陽炎型","16143",["313","559","169"]],
["560","360","瑞鳳改二乙","ずいほう","軽空母","祥鳳型","4057",["555","117","560","116"]],
["561","361","Samuel B.Roberts","サミュエル・B・ロバーツ","駆逐艦","John C.Butler級","32611",["561","681"]],
["562","362","Johnston","ジョンストン","駆逐艦","Fletcher級","32551",["562","689"]],
["563","363","巻雲改二","まきぐも","駆逐艦","夕雲型","16216",["303","563","134"]],
["564","364","風雲改二","かざぐも","駆逐艦","夕雲型","16226",["349","564","453"]],
["565","365","福江","ふかえ","海防艦","択捉型","20141",["565","685"]],
["566","366","陽炎改二","かげろう","駆逐艦","陽炎型","16016",["225","566","17"]],
["567","367","不知火改二","しらぬい","駆逐艦","陽炎型","16026",["226","567","18"]],
["568","368","黒潮改二","くろしお","駆逐艦","陽炎型","16036",["227","568","19"]],
["569","369","沖波改二","おきなみ","駆逐艦","夕雲型","16336",["359","569","452"]],
["570","370","平戸","ひらと","海防艦","択捉型","20131",["570","684"]],
["571","371","Nelson","ネルソン","戦艦","Nelson級","33021",["571","576"]],
["573","373","陸奥改二","むつ","戦艦","長門型","1106",["276","573","81"]],
["574","374","Gotland","ゴトランド","軽巡洋艦","Gotland級","36411",["574","579","630"]],
["575","375","Maestrale","マエストラーレ","駆逐艦","Maestrale級","31511",["575","580"]],
["576","376","Nelson改","ネルソン","戦艦","Nelson級","33022",["571","576"]],
["578","378","朝霜改二","あさしも","駆逐艦","夕雲型","16356",["344","578","425"]],
["579","379","Gotland改","ゴトランド","軽巡洋艦","Gotland級","36412",["574","630","579"]],
["580","380","Maestrale改","マエストラーレ","駆逐艦","Maestrale級","31512",["575","580"]],
["581","381","日進","にっしん","水上機母艦","日進型","6061",["581","690","586"]],
["583","383","峯雲","みねぐも","駆逐艦","朝潮型","15241",["583","687"]],
["584","384","八丈","はちじょう","海防艦","占守型","20031",["584","378"]],
["585","385","石垣","いしがき","海防艦","占守型","20041",["585","379"]],
["586","386","日進甲","にっしん","水上機母艦","日進型","6063",["690","586","581"]],
["587","387","海風改二","うみかぜ","駆逐艦","白露型","15136",["350","587","458"]],
["588","388","山風改二","やまかぜ","駆逐艦","白露型","15146",["369","667","457","588"]],
["589","389","L.d.S.D.d.Abruzzi","アブルッツィ","軽巡洋艦","L.d.S.D.d.Abruzzi級","31451",["589","693"]],
["590","390","G.Garibaldi","ガリバルディ","軽巡洋艦","L.d.S.D.d.Abruzzi級","31461",["590","691"]],
["591","391","金剛改二丙","こんごう","巡洋戦艦","金剛型","1017",["149","591","209","78"]],
["592","392","比叡改二丙","ひえい","巡洋戦艦","金剛型","1027",["150","592","210","86"]],
["594","404","赤城改二","あかぎ","正規空母","赤城型","2016",["277","599","83","594"]],
["595","395","Houston","ヒューストン","重巡洋艦","Northampton級","32311",["595","600"]],
["596","396","Fletcher","フレッチャー","駆逐艦","Fletcher級","32511",["596","692","628","629"]],
["597","397","Atlanta","アトランタ","軽巡洋艦","Atlanta級","32451",["597","696"]],
["598","398","Honolulu","ホノルル","軽巡洋艦","不明","32421",["598","711"]],
["599","409","赤城改二戊","あかぎ","正規空母","赤城型","2017",["594","277","599","83"]],
["600","400","Houston改","ヒューストン","重巡洋艦","Northampton級","32312",["595","600"]],
["601","401","Colorado","コロラド","戦艦","Colorado級","32011",["601","1496"]],
["602","402","South Dakota","サウスダコタ","巡洋戦艦","South Dakota級","32061",["602","697"]],
["603","403","Hornet","ホーネット","正規空母","Yorktown級","32161",["603","704"]],
["604","399","De Ruyter","デ・ロイテル","軽巡洋艦","De Ruyter級","37411",["604","609"]],
["605","1505","Luigi Torelli改","ルイージ・トレッリ","潜水艦","Guglielmo Marconi級","31712",["535","539","605","530"]],
["606","1506","伊400改","い400","潜水空母","潜特型(伊400型潜水艦)","22112",["493","606"]],
["607","1507","伊47改","い47","潜水艦","巡潜丙型","22252",["636","607"]],
["609","1494","De Ruyter改","デ・ロイテル","軽巡洋艦","De Ruyter級","37412",["604","609"]],
["610","410","加賀改二戊","かが","正規空母","加賀型","2027",["698","646","278","610","84"]],
["611","411","御蔵","みくら","海防艦","御蔵型","21011",["611","616"]],
["612","412","屋代","やしろ","海防艦","御蔵型","21061",["612","617"]],
["613","413","Perth","パース","軽巡洋艦","Perth級","38411",["613","618"]],
["614","414","Grecale","グレカーレ","駆逐艦","Maestrale級","31521",["614","619"]],
["615","415","Helena","ヘレナ","軽巡洋艦","St. Louis級","32431",["615","620"]],
["616","416","御蔵改","みくら","海防艦","御蔵型","21012",["611","616"]],
["617","417","屋代改","やしろ","海防艦","御蔵型","21062",["612","617"]],
["618","418","Perth改","パース","軽巡洋艦","Perth級","38412",["613","618"]],
["619","419","Grecale改","グレカーレ","駆逐艦","Maestrale級","31522",["614","619"]],
["620","420","Helena改","ヘレナ","軽巡洋艦","St. Louis級","32432",["615","620"]],
["621","421","神州丸","しんしゅうまる","揚陸艦","陸軍特種船(R1)","25021",["621","626"]],
["622","422","夕張改二","ゆうばり","軽巡洋艦","夕張型","10176",["293","623","115","622","624"]],
["623","423","夕張改二特","ゆうばり","軽巡洋艦","夕張型","10177",["622","624","293","623","115"]],
["624","424","夕張改二丁","ゆうばり","軽巡洋艦","夕張型","10178",["623","622","624","293","115"]],
["625","425","秋霜","あきしも","駆逐艦","夕雲型","16371",["625","695"]],
["626","426","神州丸改","しんしゅうまる","揚陸艦","陸軍特種船(R1)","25022",["621","626"]],
["627","427","敷波改二","しきなみ","駆逐艦","綾波型","14126",["208","627","14"]],
["628","428","Fletcher改 Mod.2","フレッチャー","駆逐艦","Fletcher級","32513",["692","629","596","628"]],
["629","429","Fletcher Mk.II","フレッチャー","駆逐艦","Fletcher級","32516",["628","692","629","596"]],
["630","430","Gotland andra","ゴトランド","軽巡洋艦","Gotland級","36416",["579","630","574"]],
["631","431","薄雲","うすぐも","駆逐艦","吹雪型","14071",["631","700"]],
["632","432","有明","ありあけ","駆逐艦","初春型","15051",["632","703"]],
["634","434","迅鯨","じんげい","潜水母艦","迅鯨型","7011",["634","639"]],
["635","435","長鯨","ちょうげい","潜水母艦","迅鯨型","7021",["635","640"]],
["636","436","伊47","い47","潜水艦","巡潜丙型","22251",["636","607"]],
["637","437","第四号海防艦","だいよんごう","海防艦","丁型海防艦","21311",["637","701"]],
["638","438","第三〇号海防艦","だいさんじゅうごう","海防艦","丁型海防艦","21341",["638","712"]],
["639","439","迅鯨改","じんげい","潜水母艦","迅鯨型","7012",["634","639"]],
["640","440","長鯨改","ちょうげい","潜水母艦","迅鯨型","7022",["635","640"]],
["641","441","松","まつ","駆逐艦","松型","19011",["641","702"]],
["642","442","竹","たけ","駆逐艦","松型","19021",["642","706"]],
["643","443","梅","うめ","駆逐艦","松型","19031",["643","716"]],
["644","444","桃","もも","駆逐艦","松型","19041",["644","708"]],
["645","445","宗谷","そうや","補給艦","不明","7613",["699","650","645"]],
["646","446","加賀改二護","かが","正規空母","加賀型","2028",["610","698","646","278","84"]],
["647","447","浦波改二","うらなみ","駆逐艦","吹雪型","14106",["368","647","486"]],
["648","448","秋雲改二","あきぐも","駆逐艦","陽炎型","16196",["301","648","132"]],
["649","449","高波改二","たかなみ","駆逐艦","夕雲型","16256",["345","649","424"]],
["650","450","宗谷","そうや","補給艦","不明","7615",["645","699","650"]],
["651","451","丹陽","ゆきかぜ","駆逐艦","陽炎型","16084",["228","656","20","651"]],
["652","452","球磨改二","くま","軽巡洋艦","球磨型","10036",["215","657","99","652"]],
["653","453","Scirocco","シロッコ","駆逐艦","Maestrale級","31541",["653","658"]],
["654","454","Washington","ワシントン","巡洋戦艦","不明","32051",["654","659"]],
["655","455","Northampton","ノーザンプトン","重巡洋艦","Northampton級","32301",["655","660"]],
["656","456","雪風改二","ゆきかぜ","駆逐艦","陽炎型","16086",["651","656","228","20"]],
["657","457","球磨改二丁","くま","軽巡洋艦","球磨型","10037",["652","215","657","99"]],
["658","1707","Scirocco改","シロッコ","駆逐艦","Maestrale級","31542",["653","658"]],
["659","459","Washington改","ワシントン","巡洋戦艦","不明","32052",["654","659"]],
["660","460","Northampton改","ノーザンプトン","重巡洋艦","Northampton級","32302",["655","660"]],
["662","462","能代改二","のしろ","軽巡洋艦","阿賀野型","11026",["306","662","138"]],
["663","463","矢矧改二","やはぎ","軽巡洋艦","阿賀野型","11036",["307","668","139","663"]],
["665","465","曙改二","あけぼの","駆逐艦","綾波型","14186",["231","665","15"]],
["666","466","磯波改二","いそなみ","駆逐艦","吹雪型","14096",["206","666","12"]],
["667","467","山風改二丁","やまかぜ","駆逐艦","白露型","15147",["588","369","667","457"]],
["668","468","矢矧改二乙","やはぎ","軽巡洋艦","阿賀野型","11037",["663","307","668","139"]],
["670","470","親潮改二","おやしお","駆逐艦","陽炎型","16046",["362","670","456"]],
["671","471","巻波","まきなみ","駆逐艦","夕雲型","16241",["671","709"]],
["674","474","玉波","たまなみ","駆逐艦","夕雲型","16281",["674","718"]],
["675","475","涼波","すずなみ","駆逐艦","夕雲型","16291",["675","710"]],
["678","1478","日振改","ひぶり","海防艦","日振型","21092",["551","678"]],
["679","1479","大東改","だいとう","海防艦","日振型","21102",["552","679"]],
["680","1480","浜波改","はまなみ","駆逐艦","夕雲型","16322",["484","680"]],
["681","1481","Samuel B.Roberts改","サミュエル・B・ロバーツ","駆逐艦","John C.Butler級","32612",["561","681"]],
["684","1484","平戸改","ひらと","海防艦","択捉型","20132",["570","684"]],
["685","1485","福江改","ふかえ","海防艦","択捉型","20142",["565","685"]],
["686","1486","岸波改","きしなみ","駆逐艦","夕雲型","16342",["527","686"]],
["687","1487","峯雲改","みねぐも","駆逐艦","朝潮型","15242",["583","687"]],
["688","1488","早波改","はやなみ","駆逐艦","夕雲型","16312",["528","688"]],
["689","1489","Johnston改","ジョンストン","駆逐艦","Fletcher級","32552",["562","689"]],
["690","1490","日進改","にっしん","水上機母艦","日進型","6062",["581","586","690"]],
["691","1491","G.Garibaldi改","ガリバルディ","軽巡洋艦","L.d.S.D.d.Abruzzi級","31462",["590","691"]],
["692","1492","Fletcher改","フレッチャー","駆逐艦","Fletcher級","32512",["596","628","692","629"]],
["693","1483","L.d.S.D.d.Abruzzi改","アブルッツィ","軽巡洋艦","L.d.S.D.d.Abruzzi級","31452",["589","693"]],
["695","1495","秋霜改","あきしも","駆逐艦","夕雲型","16372",["625","695"]],
["696","1496","Atlanta改","アトランタ","軽巡洋艦","Atlanta級","32452",["597","696"]],
["697","407","South Dakota改","サウスダコタ","巡洋戦艦","South Dakota級","32062",["602","697"]],
["698","405","加賀改二","かが","正規空母","加賀型","2026",["278","610","84","698","646"]],
["699","408","宗谷","そうや","補給艦","不明","7611",["699","645","650"]],
["700","1700","薄雲改","うすぐも","駆逐艦","吹雪型","14072",["631","700"]],
["701","1701","第四号海防艦改","だいよんごう","海防艦","丁型海防艦","21312",["637","701"]],
["702","1702","松改","まつ","駆逐艦","松型","19012",["641","702"]],
["703","1703","有明改","ありあけ","駆逐艦","初春型","15052",["632","703"]],
["704","1704","Hornet改","ホーネット","正規空母","Yorktown級","32162",["603","704"]],
["705","1705","Sheffield改","シェフィールド","軽巡洋艦","不明","33432",["514","705"]],
["706","1706","竹改","たけ","駆逐艦","松型","19022",["642","706"]],
["707","458","Gambier Bay Mk.II","ガンビア・ベイ","軽空母","Casablanca級","32136",["396","707","544"]],
["708","1708","桃改","もも","駆逐艦","松型","19042",["644","708"]],
["709","1709","巻波改","まきなみ","駆逐艦","夕雲型","16242",["671","709"]],
["710","1710","涼波改","すずなみ","駆逐艦","夕雲型","16292",["675","710"]],
["711","1711","Honolulu改","ホノルル","軽巡洋艦","不明","32422",["598","711"]],
["712","1712","第三〇号海防艦改","だいさんじゅうごう","海防艦","丁型海防艦","21342",["638","712"]],
["713","1713","Victorious改","ヴィクトリアス","装甲空母","不明","33172",["885","713"]],
["714","1714","昭南改","しょうなん","海防艦","日振型","21112",["895","714"]],
["715","1715","Scamp改","スキャンプ","潜水艦","不明","32732",["299","715"]],
["716","1716","梅改","うめ","駆逐艦","松型","19032",["643","716"]],
["717","1717","山汐丸改","やましおまる","補給艦","不明","25052",["900","717"]],
["718","1718","玉波改","たまなみ","駆逐艦","夕雲型","16282",["674","718"]],
["877","477","Conte di Cavour","カブール","戦艦","不明","31011",["877","878","879"]],
["878","478","Conte di Cavour改","カブール","巡洋戦艦","不明","31012",["877","879","878"]],
["879","479","Conte di Cavour nuovo","カブール","巡洋戦艦","不明","31013",["878","879","877"]],
["882","482","伊203","い203","潜水艦","不明","22301",["882","887"]],
["883","483","龍鳳改二戊","たいげい・りゅうほう","軽空母","龍鳳型","4037",["318","888","185","883","184"]],
["884","484","雲鷹","うんよう","軽空母","大鷹型","5022",["522","382","884","889"]],
["885","485","Victorious","ヴィクトリアス","装甲空母","不明","33171",["885","713"]],
["887","487","伊203改","い203","潜水艦","不明","22302",["882","887"]],
["888","488","龍鳳改二","たいげい・りゅうほう","軽空母","龍鳳型","4036",["883","318","888","185","184"]],
["889","489","雲鷹改二","うんよう","軽空母","大鷹型","5026",["382","889","884","522"]],
["893","1493","Janus改","ジェーナス","駆逐艦","J級","33522",["520","893"]],
["895","495","昭南","しょうなん","海防艦","日振型","21111",["895","714"]],
["900","500","山汐丸","やましおまる","補給艦","不明","25051",["900","717"]],
["903","503","天霧改二","あまぎり","駆逐艦","綾波型","14156",["390","908","479","903"]],
["908","508","天霧改二丁","あまぎり","駆逐艦","綾波型","14157",["903","390","908","479"]],
["1496","406","Colorado改","コロラド","戦艦","Colorado級","32012",["601","1496"]]
];
      // ページ読み込み時に実行
      window.onload = function () {
        preLoadImg(); // 画像プリロード
        loadData(); //セーブデータのロード
        adjustLayout(); //画面レイアウトの調整
      }
      //セーブデータのロード
      function loadData() {
        let json = localStorage.getItem("saveDataArray");
        let saveDataArray = JSON.parse(json);
        if (saveDataArray !== null) {
          for (let sDA of saveDataArray) {
            MakeSheet(sDA[0], sDA[1], sDA[2], sDA[3], sDA[4], sDA[5]);
          }
        }
      }
      // 画像プリロード用関数
      function preLoadImg() {
        var img;
        for (i = 0; i < DataTable.length; i++) {
          img = document.createElement('img');
          img.src = 'img/' + DataTable[i][0] + '.png';
        }
      }
      //ウインドウサイズ変更時に実行(cssへの敗北)
      window.onresize = function () {
         adjustLayout();
      };
      //艦隊情報読み込み
      function inputKanmusuData() {
        //テキストボックスの文字列を取得
        let newTxt = event.target.value;
        //ローカルストレージにテキストボックスの文字列を保存
        localStorage.setItem('kantaibunsekitxt', newTxt);
        //正規表現パターンを設定して検索
        let regexpNames = /\"api_ship_id\":(\d+),\"api_lv\":(\d+)/ig;
        let match; // = regexpNames.exec(newTxt);
        //リストを初期化
        for (tab_sort of event.target.closest('.splitLeft').getElementsByClassName("kantaiList")) {
          while (tab_sort.firstChild) {
            tab_sort.removeChild(tab_sort.firstChild);
          }
        }
        //艦隊リスト内の艦娘の固有ID
        let shipDataID = 0;
        //マッチしたパターンを処理
        while ((match = regexpNames.exec(newTxt)) !== null) {
          let DataIdx = DataTable.map(item => item[0]).indexOf(`${match[1]}`);
          shipData = DataTable[DataIdx];
          shipDataID++;
          //艦種を判定
          switch (shipData[4]) {
          case "海防艦":
            SelectListTab = "tab_kaibou";
            break;
          case "駆逐艦":
            SelectListTab = "tab_kutiku";
            break;
          case "軽巡洋艦":
          case "重雷装巡洋艦":
          case "練習巡洋艦":
            SelectListTab = "tab_keijun";
            break;
          case "重巡洋艦":
          case "航空巡洋艦":
            SelectListTab = "tab_juujun";
            break;
          case "軽空母":
          case "正規空母":
          case "装甲空母":
            SelectListTab = "tab_koukuu";
            break;
          case "巡洋戦艦":
          case "戦艦":
          case "航空戦艦":
            SelectListTab = "tab_senkan";
            break;
          case "潜水艦":
          case "潜水空母":
            SelectListTab = "tab_sensui";
            break;
          default:
            SelectListTab = "tab_hojo";
          }
          //艦娘のリスト要素を作成
          shipInfoText = makeNewShip(shipDataID, shipData, `${match[2]}`);
          shipInfoText.setAttribute('ondragstart', 'henseiDragStart()');
          shipInfoText.setAttribute('ondragover', 'henseiDragOver()');
          shipInfoText.setAttribute('ondragleave', 'henseiDragLeave()');
          shipInfoText.setAttribute('ondrop', 'henseiOnDrop()');
          //艦娘要素をリストに追加
          event.target.closest('.splitLeft').getElementsByClassName(SelectListTab)[0].appendChild(shipInfoText);
        }
        //艦隊の艦娘を並べ替え
        　
        event.target.closest('.splitLeft').getElementsByClassName("lst_ListSort")[0].addEventListener('onchange', ListSort);　
        event.target.closest('.splitLeft').getElementsByClassName("lst_ListSort")[0].dispatchEvent(new Event('onchange'));
      }
      //リストの要素を属性の値で並べ替える
      //ListObj:リストのID(tab_hojo等)、sortAttr:並べ替えに使う属性名(data-shipSort)、ascOrdesc:(昇順:1 降順:-1)
      function compareLv(ListObj, sortAttr, ascOrdesc) {
        tmpList = Array.prototype.slice.call(ListObj.childNodes);
        tmpList.sort(function (a, b) {
          return (a.getAttribute(sortAttr) - b.getAttribute(sortAttr)) * ascOrdesc;
        });
        for (let i = 0; i < tmpList.length; i++) {
          ListObj.appendChild(ListObj.removeChild(tmpList[i]))
        }
      }
      //艦娘のリスト要素を作成
      function makeNewShip(shipDataID, shipData, LvTxt) {
        let shipInfoText = document.createElement('li');
        shipInfoText.classList.add('ship' + shipDataID);
        shipInfoText.classList.add('kantaiItem');
        shipInfoText.draggable = 'true';
        shipInfoText.setAttribute('data-shipname', shipData[2]);
        shipInfoText.setAttribute('data-shipid', shipData[0]);
        shipInfoText.setAttribute('data-shiplv', LvTxt);
        shipInfoText.setAttribute('data-shipclass', shipData[4]);
        shipInfoText.setAttribute('data-shiptype', shipData[5]);
        shipInfoText.setAttribute('data-shipsort', shipData[6]);
        shipInfoText.setAttribute('data-shipsameid', shipData[7]);
        shipInfoText.setAttribute('data-fudaIdx', -1);
        shipInfoText.setAttribute('title', shipData[2] + '\nLv' + LvTxt);
        let shipImgTag = document.createElement('img');
        shipImgTag.src = 'img/' + shipData[0] + '.png';
        shipImgTag.classList.add('shipimg');
        shipImgTag.setAttribute('draggable', false);
        let shipNameTag = document.createElement('div');
        shipNameTag.classList.add('shipname');
        shipNameTag.innerHTML = shipData[2];
        let shipLvTag = document.createElement('div');
        shipLvTag.classList.add('shiplv');
        shipLvTag.innerHTML = 'Lv' + LvTxt;
        let shipAreaTag = document.createElement('div');
        shipAreaTag.classList.add('shiparea');
        shipInfoText.appendChild(shipImgTag);
        shipInfoText.appendChild(shipNameTag);
        shipInfoText.appendChild(shipLvTag);
        shipInfoText.appendChild(shipAreaTag);
        return shipInfoText;
      }
      //編成条件と特効情報の状態を更新する
      function checkHenseiAndTokkou(e) {
        e.closest('.kantaiHenseiAll').getElementsByClassName('txtr_kantaitokkou')[0].addEventListener('oninput', ChangeTokkouList);
        e.closest('.kantaiHenseiAll').getElementsByClassName('txtr_kantaitokkou')[0].dispatchEvent(new Event('oninput'));
        e.closest('.kantaiHenseiAll').getElementsByClassName('txtr_kantaiCaution')[0].addEventListener('oninput', ChangeHenseiList);
        e.closest('.kantaiHenseiAll').getElementsByClassName('txtr_kantaiCaution')[0].dispatchEvent(new Event('oninput'));
      }
      //アプリ全体の状態をローカルストレージに保存
      function MakeAllSaveData() {
        saveDataArray = [];
        let r, f, h, s;
        for (let i of document.getElementsByClassName('sheetcontents')) {
          if ((i.childElementCount === 0)) {
            break;
          }
          r = [];
          f = i.getElementsByClassName('lst_fudaList')[0];
          for (let k = 0; k < f.length; k++) {
            r.push([
              f[k].innerText,
              f[k].style.color,
              f[k].style.backgroundColor
            ]);
          }
          h = [];
          for (let f of i.getElementsByClassName('kantaiHenseiAll')) {
            s = [];
            for (let g of f.getElementsByClassName('henseiItem')) {
              s.push(g.classList[0]);
            }
            h.push([
              f.getElementsByClassName('henseiName')[0].value,
              f.getElementsByClassName('lst_fudaList')[0].selectedIndex,
              f.getElementsByClassName('lit_kantaiSize')[0].selectedIndex,
              s,
              f.getElementsByClassName('txtr_kantaiCaution')[0].value,
              f.getElementsByClassName('txtr_kantaitokkou')[0].value
            ]);
          }
          saveDataArray.push([
            i.previousElementSibling.getElementsByClassName('sheet_name_label')[0].value,
            r,
            i.getElementsByClassName('lst_fudaList')[0].selectedIndex,
            i.getElementsByClassName('kantaiJouhou')[0].value,
            i.getElementsByClassName('lst_ListSort')[0].selectedIndex,
            h
          ]);
        }
        let json = JSON.stringify(saveDataArray, undefined, 1);
        localStorage.setItem('saveDataArray', json);
        alert('ページをセーブしました');
      }
      //新規シートを作成
      function MakeNewSheet() {
        let sName = "新規シート";
        let kantaiStr = "";
        MakeSheet(sName, newfudaInfoArray(), 0, kantaiStr, 0, [newhenseiArray()]);
        adjustLayout();
      }
      //hexをcolorに変換
      function HexToClr(HexData) {
        return "rgb(" + parseInt(HexData[1] + HexData[2], 16) + "," + parseInt(HexData[3] + HexData[4], 16) + "," + parseInt(HexData[5] + HexData[6], 16) + ")";
      }
      //colorをhexに変換
      function ClrToHex(ColorData) {
        let c = ColorData.slice(4, ColorData.length - 1).split(",");
        rTxt = Number(c[0]).toString(16);
        gTxt = Number(c[1]).toString(16);
        bTxt = Number(c[2]).toString(16);
        return "#" + "0".repeat(2 - rTxt.length) + rTxt + "0".repeat(2 - gTxt.length) + gTxt + '0'.repeat(2 - bTxt.length) + bTxt;
      }
      //ダイアログを閉じる
      function closeSettingDialog() {
        event.target.closest('dialog').close();
      }
      //艦隊セッティングダイアログを開く
      function showKantaiSettingDialog() {
        let d = event.target.closest('.sheetcontents').getElementsByClassName('dlg_importkantai')[0];
        let s = d.getElementsByTagName('select')[0];
        d.show();
        let sIDtext = event.target.closest('.sheetcontents').previousElementSibling.getAttribute('for');
        let sht = event.target.closest('.sheetselection').getElementsByClassName('sheet_tab');
        let op = document.createElement('option');
        while (s.firstChild) {
          s.removeChild(s.firstChild);
        }
        let i = 0;
        for (let ss of sht) {
          if (ss.getAttribute('for') !== 'add_sheet' && ss.getAttribute('for') !== sIDtext) {
            op.innerText = ss.getElementsByClassName('sheet_name_label')[0].value;
            op.setAttribute('data-sheetIdx', i);
            s.appendChild(op.cloneNode(true));
          }
          i++;
        }
        let kJ = event.target.closest('.sheetcontents').getElementsByClassName('kantaiJouhou')[0];
        //テキストエリアに艦隊情報のテキストを転記
        event.target.closest('.sheetcontents').getElementsByClassName('dlg_importkantai')[0].getElementsByTagName('textarea')[0].value = kJ.value;
        //テキストエリアにフォーカス
        event.target.closest('.sheetcontents').getElementsByClassName('dlg_importkantai')[0].getElementsByTagName('textarea')[0].focus();
        //未実装
        //セレクトボックスのサイズが0の場合
        //ラジオボタンの上側を選択して下側を無効にする 
      }
      //札セッティングダイアログを開く
      function showFudaSettingDialog() {
        event.target.closest('.sheetcontents').getElementsByClassName('dlg_fudaColor')[0].show();
        let a = event.target.closest('.sheetcontents').getElementsByClassName('lst_fudaList')[0].getElementsByTagName('option');
        let b = event.target.closest('.sheetcontents').getElementsByTagName('input');
        for (let i = 0; i < a.length; i++) {
          b[i * 3].value = a[i].innerHTML;
          b[i * 3].style.color = ClrToHex(a[i].style.color);
          b[i * 3].style.backgroundColor = ClrToHex(a[i].style.backgroundColor);
          b[i * 3 + 1].value = ClrToHex(a[i].style.color);
          b[i * 3 + 2].value = ClrToHex(a[i].style.backgroundColor);
        }
        let d = event.target.closest('.sheetcontents').getElementsByClassName('dlg_fudaColor')[0];
        let s = d.getElementsByTagName('select')[0];
        let sIDtext = event.target.closest('.sheetcontents').previousElementSibling.getAttribute('for');
        let sht = event.target.closest('.sheetselection').getElementsByClassName('sheet_tab');
        let op = document.createElement('option');
        while (s.firstChild) {
          s.removeChild(s.firstChild);
        }
        i = 0;
        imemo = 0;
        for (let ss of sht) {
          if (ss.getAttribute('for') !== 'add_sheet') {
            op.innerText = ss.getElementsByClassName('sheet_name_label')[0].value;
            op.setAttribute('data-sheetIdx', i);
            s.appendChild(op.cloneNode(true));
            if (ss.getAttribute('for') === sIDtext) {
              imemo = i;
            }
          }
          i++;
        }
        s.selectedIndex = imemo;
      }
      //艦隊情報のダイアログで設定する
      function setKantaiDeal() {
        let r = event.target.closest('dialog').getElementsByTagName('input');
        for (let rr of r) {
          if (rr.checked) {
            if (rr.value === 'kantai_reset') {
              //艦隊リセット(ラジオボタン上側)
              let kJ = event.target.closest('.sheetcontents').getElementsByClassName('kantaiJouhou')[0];
              //艦隊情報のテキストにテキストエリアの情報を転記
              kJ.value = event.target.closest('dialog').getElementsByTagName('textarea')[0].value;
              //艦隊情報の読み込みイベントを発生させる
              kJ.addEventListener('oninput', inputKanmusuData);
              kJ.dispatchEvent(new Event('oninput'));
              //編成艦娘をすべて外す
              let sc = event.target.closest('.sheetcontents');
              let kh = sc.querySelectorAll('.kantaiHensei');
              let hIArray;
              let hIArrayLength;
              let ekkh;
              let removeFlag;
              for (let kkh of kh) {
                hIArray = kkh.querySelectorAll('.henseiItem');
                hIArrayLength = hIArray.length;
                removeFlag = false;
                //情報の入っている艦娘アイテムを削除する
                for (i = 0; i < hIArrayLength; i++) {
                  if (hIArray[hIArrayLength - 1 - i].getAttribute('data-fudaidx') != -1) {
                    hIArray[hIArrayLength - 1 - i].remove();
                    removeFlag = true;
                  }
                }
                //艦娘が削除されている場合、イベントを発生させて補充する
                if (removeFlag) {
                  ekkh = kkh.parentNode.getElementsByClassName('lit_kantaiSize')[0];
                  ekkh.addEventListener('onchange', setkantaiSize);
                  ekkh.dispatchEvent(new Event('onchange'));
                }
              }
            } else {
              //艦隊置き換え(ラジオボタン下側)
              //新規でシートを作成して、現シート(編成参照元)の1隻以上艦娘がいる編成を新規のシートにコピー
              //その後ろ側に参照シート(艦隊参照元)の1隻以上艦娘がいる編成を新規のシートに続けてコピー
              //参照シート(艦隊参照元)の艦隊を新規のシートにコピー
              //
              let s = event.target.closest('dialog').getElementsByTagName('select')[0];
              let sIdx = s.getElementsByTagName('option')[s.selectedIndex].getAttribute('data-sheetidx');
              let quoteSheet = event.target.closest('.sheetselection').getElementsByClassName('sheetcontents')[sIdx];
              //引用するシートから1隻以上の艦娘が存在する編成セットをコピーしてそのまま持ってくる
              let quoteHensei = quoteSheet.getElementsByClassName('kantaiHenseiAll');
              let insObj, setObj;
              let newSheetName = event.target.closest('.sheetcontents').previousElementSibling.getElementsByClassName('sheet_name_label')[0].value + 'で' + s.value + 'を編成';
              //新しいシートを作成
              MakeSheet(newSheetName, newfudaInfoArray(), 0, "", 0, [newhenseiArray()]);
              //新しいシート
              let newSheet = event.target.closest('.sheetselection').getElementsByClassName('sheetcontents')[event.target.closest('.sheetselection').getElementsByClassName('sheetcontents').length - 2];
              //シート生成時に作成される最初の空編成を削除
              newSheet.getElementsByTagName('tr')[0].removeChild(newSheet.getElementsByTagName('tr')[0].firstChild);
              //現シート(編成参照元)の編成を新規のシートにコピ
              for (qH of event.target.closest('.sheetcontents').getElementsByClassName('kantaiHenseiAll')) {
                insObj = newSheet.getElementsByTagName('tr')[0].insertCell(-1);
                insObj.outerHTML = qH.cloneNode(true).outerHTML;
                setObj = newSheet.getElementsByTagName('tr')[0].lastElementChild;
                setObj.getElementsByClassName('henseiName')[0].value = qH.getElementsByClassName('henseiName')[0].value;
                setObj.getElementsByClassName('txtr_kantaiCaution')[0].value = qH.getElementsByClassName('txtr_kantaiCaution')[0].value;
                setObj.getElementsByClassName('txtr_kantaitokkou')[0].value = qH.getElementsByClassName('txtr_kantaitokkou')[0].value;
                setObj.getElementsByClassName('lit_kantaiSize')[0].selectedIndex = qH.getElementsByClassName('lit_kantaiSize')[0].selectedIndex;
                setObj.getElementsByClassName('lst_fudaList')[0].selectedIndex = qH.getElementsByClassName('lst_fudaList')[0].selectedIndex;
              }
              //編成数のメモ
              let beforeHenseiCount = newSheet.getElementsByClassName('kantaiHenseiAll').length;
              //参照シート(艦隊参照元)の1隻以上艦娘がいる編成を新規のシートに続けてコピー
              for (qH of quoteHensei) {
                hI = qH.getElementsByClassName('henseiItem');
                judgeQuote = false;
                for (hhI of hI) {
                  if (hhI.classList.contains('ship0') !== true) {
                    judgeQuote = true;
                  }
                }
                if (judgeQuote === true) {
                  insObj = newSheet.getElementsByTagName('tr')[0].insertCell(-1);
                  insObj.outerHTML = qH.cloneNode(true).outerHTML;
                  setObj = newSheet.getElementsByTagName('tr')[0].lastElementChild;
                  setObj.getElementsByClassName('henseiName')[0].value = '(シート:' + s.value + ')' + qH.getElementsByClassName('henseiName')[0].value;
                  setObj.getElementsByClassName('txtr_kantaiCaution')[0].value = qH.getElementsByClassName('txtr_kantaiCaution')[0].value;
                  setObj.getElementsByClassName('txtr_kantaitokkou')[0].value = qH.getElementsByClassName('txtr_kantaitokkou')[0].value;
                  setObj.getElementsByClassName('lit_kantaiSize')[0].selectedIndex = qH.getElementsByClassName('lit_kantaiSize')[0].selectedIndex;
                  setObj.getElementsByClassName('lst_fudaList')[0].selectedIndex = qH.getElementsByClassName('lst_fudaList')[0].selectedIndex;
                }
              }　　　 //艦隊テキストをコピー
              　　　　　
              newSheet.getElementsByClassName('kantaiJouhou')[0].value = quoteSheet.getElementsByClassName('kantaiJouhou')[0].value
              //艦隊の状態をコピー
              for (let i = 0; i < quoteSheet.getElementsByClassName('kantaiList').length; i++) {
                newSheet.getElementsByClassName('kantaiList')[i].outerHTML = quoteSheet.getElementsByClassName('kantaiList')[i].cloneNode(true).outerHTML;
              }
              //札一式をコピー
              let newSheetHensei = newSheet.getElementsByClassName('kantaiHenseiAll');
              for (let i = 0; i < beforeHenseiCount; i++) {
                henseiFuda = newSheetHensei[beforeHenseiCount - i - 1].getElementsByClassName('lst_fudaList')[0].selectedIndex;
                //最後側の編成を優先
                for (hI of newSheetHensei[beforeHenseiCount - i - 1].getElementsByClassName('henseiItem'))

                  if (hI.getAttribute('data-fudaidx') !== "-1") {
                    hI.classList.remove(hI.classList[0]);
                    hI.classList.remove(hI.classList[0]);
                    hI.classList.add("ship0");
                    hI.classList.add("henseiItem");
                    //同じ札が付いた艦隊の同じ艦娘を検索
                    matchkIs = newSheet.getElementsByClassName('area')[0].querySelectorAll('[data-shipid="' + hI.getAttribute('data-shipid') + '"][data-fudaidx="' + henseiFuda + '"]');　
                    if (matchkIs.length === 0) {
                      //札が付いていない艦隊の同じ艦娘を検索                         
                      matchkIs = newSheet.getElementsByClassName('area')[0].querySelectorAll('[data-shipid="' + hI.getAttribute('data-shipid') + '"][data-fudaidx="-1"]');
                    }
                    if (matchkIs.length === 0) {
                      //編成できる艦娘がいない場合
                      hI.setAttribute('data-shipname', '編成なし');
                      hI.setAttribute('data-shipid', '0');
                      hI.setAttribute('data-shiplv', '-');
                      hI.setAttribute('data-shipclass', '0');
                      hI.setAttribute('data-shiptype', '0');
                      hI.setAttribute('data-shipsort', '0');
                      hI.setAttribute('data-shipsameid', '0');
                      hI.setAttribute('data-fudaIdx', '-1');
                      hI.setAttribute('title', '編成なし' + '\nLv' + '-');
                      hI.getElementsByClassName('shiplv')[0].innerHTML = '編成可能艦なし';
                      hI.getElementsByClassName('shiplv')[0].style.backgroundColor = "red";
                      hI.getElementsByClassName('shiparea')[0].innerHTML = '';
                    } else {
                      //艦娘が編成できる場合LVが高い艦娘を優先的に編成する
                      mlv = 1;
                      mlvidx = 0;
                      for (k = 0; k < matchkIs.length; k++) {
                        if (mlv < matchkIs[k].getAttribute('data-shiplv')) {
                          mlv = matchkIs[k].getAttribute('data-shiplv');
                          mlvidx = k;
                        }
                      }
                      trySetHenseiItem(matchkIs[mlvidx], hI);
                    }
                  }
              }
            }
          }
        }
        event.target.closest('dialog').close();
      }
      //スタイルシートの変更
      function changeStyleSheet() {
        switch (event.target.selectedIndex) {
        case 0:
          document.getElementById("cssLink").href = "style/style.css";
          break;
        case 1:
          document.getElementById("cssLink").href = "style/smallstyle.css";
        }
      }
      //札を更新
      function setfudaselectbox() {
        let a = event.target.closest('.sheetcontents').getElementsByClassName('lst_fudaList')[0].getElementsByTagName('option');
        let b = event.target.closest('.sheetcontents').getElementsByTagName('input');
        for (let i = 0; i < a.length; i++) {
          a[i].innerHTML = b[i * 3].value;
          a[i].style.color = HexToClr(b[i * 3 + 1].value);
          a[i].style.backgroundColor = HexToClr(b[i * 3 + 2].value);
        }
        //同じシートの札のセレクトボックスの中身をすべて更新する
        let c = event.target.closest('.sheetcontents').getElementsByClassName('lst_fudaList');
        for (let cc of c) {
          let cidx = cc.selectedIndex;
          cc.innerHTML = c[0].innerHTML;
          cc.selectedIndex = cidx;
        }
        //艦娘の札表記を更新する
        let s = event.target.closest('.sheetcontents').querySelectorAll('.kantaiItem, .henseiItem');
        for (let ss of s) {
          let idx = Number(ss.getAttribute('data-fudaidx'));
          if (idx !== -1) {
            ss.getElementsByClassName('shiparea')[0].innerHTML = a[idx].innerHTML;
            ss.getElementsByClassName('shiparea')[0].style.color = a[idx].style.color;
            ss.getElementsByClassName('shiparea')[0].style.backgroundColor = a[idx].style.backgroundColor;
          }
        }
        //ダイアログを閉じる
        event.target.closest('dialog').close();
      }
      //札の色情報を読み込む
      function readFudaColor() {
        // let a = event.target.closest('.sheetcontents').getElementsByClassName('lst_fudaList')[0].getElementsByTagName('option');
        let a = event.target.closest('.sheetselection').getElementsByClassName('splitLeft')[event.target.selectedIndex].getElementsByClassName('lst_fudaList')[0].getElementsByTagName('option');
        let b = event.target.closest('.sheetcontents').getElementsByTagName('input');
        for (let i = 0; i < a.length; i++) {
          b[i * 3].value = a[i].innerHTML;
          b[i * 3].style.color = ClrToHex(a[i].style.color);
          b[i * 3].style.backgroundColor = ClrToHex(a[i].style.backgroundColor);
          b[i * 3 + 1].value = ClrToHex(a[i].style.color);
          b[i * 3 + 2].value = ClrToHex(a[i].style.backgroundColor);
        }
      }

      function changeFudaTextColor() {
        event.target.previousElementSibling.style.color = event.target.value;
      }

      function changeFudaTextBackgroundcolor() {
        event.target.previousElementSibling.previousElementSibling.style.backgroundColor = event.target.value;
      }
      //情報を読み込んだシートを作成する
      function MakeSheet(sheetName, fudaInfoArray, fudaIdx, kantaiStr, sortIdx, henseiArray) {
        MakeSheetTab(sheetName); //新規シートのタブを作成する
        //エレメント操作用の変数
        let sc, e1, e2, e3, e4, e5, e6;
        let f = document.createDocumentFragment();
        //sc 新規で作成するシートオブジェクト
        sc = document.getElementsByClassName('sheetcontents')[document.getElementsByClassName('sheetcontents').length - 2];
        //札設定ダイアログを作成
        e2 = document.createElement("dialog");
        e2.classList.add('dlg_fudaColor');
        e2.style.zIndex = 1;
        e3 = document.createElement("label");
        e3.append(document.createTextNode('出撃札の設定'));
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        for (let i = 0; i < 10; i++) {
          e3 = document.createElement("input");
          e3.setAttribute('type', 'text');
          e2.appendChild(e3.cloneNode(true));
          e3 = document.createElement("input");
          e3.setAttribute('type', 'color');
          e3.setAttribute('onchange', 'changeFudaTextColor()');
          e2.appendChild(e3.cloneNode(true));
          e3 = document.createElement("input");
          e3.setAttribute('type', 'color');
          e3.setAttribute('onchange', 'changeFudaTextBackgroundcolor()');
          e2.appendChild(e3.cloneNode(true));
          //<br>
          e2.appendChild(document.createElement('br'));
        }
        e3 = document.createElement("label");
        e3.append(document.createTextNode('シートから引用'));
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        e3 = document.createElement("select");
        e3.setAttribute('onchange', 'readFudaColor()');
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        e2.appendChild(document.createElement('br'));
        e3 = document.createElement("input");
        e3.setAttribute('type', 'button');
        e3.setAttribute('value', 'キャンセル');
        e3.setAttribute('onclick', 'closeSettingDialog()');
        e3.style.float = 'right';
        e2.appendChild(e3.cloneNode(true));
        e3 = document.createElement("input");
        e3.setAttribute('type', 'button');
        e3.setAttribute('value', '設定');
        e3.setAttribute('onclick', 'setfudaselectbox()');
        e3.style.float = 'right';
        e2.appendChild(e3.cloneNode(true));
        sc.appendChild(e2.cloneNode(true));
        //艦隊設定ダイアログを作成
        e2 = document.createElement("dialog");
        e2.classList.add('dlg_importkantai');
        e2.style.zIndex = 1;
        e3 = document.createElement("label");
        e3.append(document.createTextNode('艦隊の読み込み'));
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        //radioの識別のためsheetIDを取得
        let sIDtext = sc.previousElementSibling.getAttribute('for');
        e4 = document.createElement("input");
        e4.setAttribute('type', 'radio');
        e4.setAttribute('name', sIDtext + '_kantai');
        e4.setAttribute('value', 'kantai_reset');
        e4.Id = sIDtext + '_reset';
        e4.checked = true;
        //e2.appendChild(e3.cloneNode(true));
        e3 = document.createElement("label");
        //e3.setAttribute('for',sIDtext + '_reset');
        e3.appendChild(e4.cloneNode(true));
        e3.append(document.createTextNode('艦隊の置き換え(艦娘は全て編成を解除されます)'));
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        e3 = document.createElement("label");
        e3.append(document.createTextNode('艦隊情報入力(艦隊分析形式)'));
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        e3 = document.createElement("textarea");
        e3.style.width = '100%';
        e3.setAttribute('onfocus', "this.select();");
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        e4 = document.createElement("input");
        e4.setAttribute('type', 'radio');
        e4.setAttribute('name', sIDtext + '_kantai');
        e4.setAttribute('value', 'kantai_replace');
        e4.Id = sIDtext + '_replace';
        // e4.appendChild(e3.cloneNode(true));
        e3 = document.createElement("label");
        // e3.setAttribute('for',sIDtext + '_replace');
        e3.appendChild(e4.cloneNode(true));
        e3.append(document.createTextNode('別のシートの艦隊を用いて可能な限り現編成を再現'));
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        e3 = document.createElement("label");
        e3.append(document.createTextNode('別シートの選択'));
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        e3 = document.createElement("select");
        e2.appendChild(e3.cloneNode(true));
        //<br>
        e2.appendChild(document.createElement('br'));
        e3 = document.createElement("input");
        e3.setAttribute('type', 'button');
        e3.setAttribute('value', 'キャンセル');
        e3.setAttribute('onclick', 'closeSettingDialog()');
        e3.style.float = 'right';
        e2.appendChild(e3.cloneNode(true));
        e3 = document.createElement("input");
        e3.setAttribute('type', 'button');
        e3.setAttribute('value', '艦隊を設定');
        e3.setAttribute('onclick', 'setKantaiDeal()');
        e3.style.float = 'right';
        e2.appendChild(e3.cloneNode(true));
        sc.appendChild(e2.cloneNode(true));
        //div Leftを作成
        e1 = document.createElement("div");
        e1.classList.add('splitLeft');
        //ここから折り畳み
        //ラベル：札名編集
        e2 = document.createElement("label");
        e2.append(document.createTextNode('基本設定'));
        e1.appendChild(e2.cloneNode(true));
        //<br>
        e1.appendChild(document.createElement('br'));
        //札のドロップダウンリスト
        e2 = document.createElement("select");
        e2.classList.add('lst_fudaList');
        e2.setAttribute('onchange', 'selectFuda()');
        e2 = makeSelectBox(e2, fudaInfoArray);
        e1.appendChild(e2.cloneNode(true));
        //出撃札編集ダイアログ表示
        e2 = document.createElement("input");
        e2.setAttribute('type', 'button');
        e2.setAttribute('onclick', 'showFudaSettingDialog()');
        e2.setAttribute('value', '出撃札編集');
        e1.appendChild(e2.cloneNode(true));
        //艦隊情報読み込みダイアログ表示
        e2 = document.createElement("input");
        e2.setAttribute('type', 'button');
        e2.setAttribute('onclick', 'showKantaiSettingDialog()');
        e2.setAttribute('value', '艦隊情報入力');
        e1.appendChild(e2.cloneNode(true));
        //<br>
        //        e1.appendChild(document.createElement('br'));
        //        //ラベル：札名編集
        //        e2 = document.createElement("label");
        //        e2.append(document.createTextNode('艦隊分析ページ形式のデータ読み込み'));
        //        e1.appendChild(e2.cloneNode(true));
        //        //<br>
        //        e1.appendChild(document.createElement('br'));
        //艦隊入力テキスト
        e2 = document.createElement("input");
        e2.classList.add('kantaiJouhou');
        e2.setAttribute('type', 'text');
        e2.setAttribute('oninput', 'inputKanmusuData()');
        e2.value = kantaiStr;
        //追記した
        e2.style.display = 'none';
        //追記ここまで
        e1.appendChild(e2.cloneNode(true));
        //<br>
        e1.appendChild(document.createElement('br'));
        //札のドロップダウンリスト
        e2 = document.createElement("select");
        e2.classList.add('lst_ListSort');
        e2.setAttribute('onchange', 'ListSort()');
        e2 = makeSelectBox(e2, [
          ['Lv↑', '#ffffff', '#000000'],
          ['Lv↓', '#ffffff', '#000000'],
          ['艦種↑', '#ffffff', '#000000'],
          ['艦種↓', '#ffffff', '#000000'],
          ['札有', '#ffffff', '#000000'],
          ['札無', '#ffffff', '#000000']
        ]);
        e1.appendChild(e2.cloneNode(true));
        //艦隊表示領域
        e2 = document.createElement("div");
        e2.classList.add('area');
        let idNames = makeNewId('tab_fleetsort', 8);
        let kantaiSizeNames = ['通常艦隊', '水上打撃', '空母機動', '輸送護衛', '遊撃部隊'];
        let labelNames = ['戦艦級', '航空母艦', '重巡級', '軽巡級', '駆逐級', '海防艦', '潜水艦', '補助艦艇'];
        let ulTabNames = ['tab_senkan', 'tab_koukuu', 'tab_juujun', 'tab_keijun', 'tab_kutiku', 'tab_kaibou', 'tab_sensui', 'tab_hojo'];
        for (let i = 0; i < 8; i++) {
          //input type radio～
          e3 = document.createElement("input");
          e3.setAttribute('type', 'radio');
          //ここから追記
          e3.classList.add('defaultHideRadios');
          //ここまで
          e3.setAttribute('name', sc.previousElementSibling.getAttribute('for') + '_kanshu');
          e3.id = idNames[i];　
          e3.setAttribute('onclick', 'adjustLayout()')
          e3.checked = (i === 0);
          f.append(e3.cloneNode(true));
          //label class = "tab_class"～
          e3 = document.createElement("label");
          e3.classList.add('tab_class');
          e3.setAttribute('for', idNames[i]);
          e3.append(document.createTextNode(labelNames[i]));
          f.append(e3.cloneNode(true));
          //ul class = "kantaiList"～
          e3 = document.createElement("ul");
          e3.classList.add('kantaiList');
          e3.classList.add(ulTabNames[i]);
          f.append(e3.cloneNode(true));
        }
        e2.appendChild(f.cloneNode(true));
        e1.appendChild(e2.cloneNode(true));
        //シートオブジェクトにdiv Left要素を追加
        sc.appendChild(e1.cloneNode(true));
        //div Rightを作成
        e1 = document.createElement("div");
        e1.classList.add('splitRight');
        //艦隊表示領域
        e2 = document.createElement("table");
        e3 = document.createElement("tr");
        //艦隊    
        e4 = document.createElement("td");
        e4.classList.add('kantaiHenseiAll');
        e4.setAttribute('draggable', true);
        e4.setAttribute('ondragstart', 'henseiDragStart()');
        e4.setAttribute('ondragover', 'henseiDragOver()');
        e4.setAttribute('ondragleave', 'henseiDragLeave()');
        e4.setAttribute('ondrop', 'henseiOnDrop()');
        f = document.createDocumentFragment();
        //ラベル「編成名」
        　
        e5 = document.createElement("label");
        e5.append(document.createTextNode("編成名"));
        f.append(e5.cloneNode(true));
        //ボタン削除
        e5 = document.createElement("button");
        e5.append(document.createTextNode(" × "));
        e5.classList.add('closeButton');
        e5.setAttribute('onclick', 'removeHensei()');
        f.append(e5.cloneNode(true));
        //ボタンコピー
        e5 = document.createElement("button");
        e5.classList.add('btn_addHensei');
        e5.append(document.createTextNode("Copy→"));
        e5.setAttribute('onclick', 'addHensei()');
        f.append(e5.cloneNode(true));
        //<br>
        f.append(document.createElement("br"));
        //編成名記入テキスト
        //        e5 = document.createElement("input");　
        e5 = document.createElement("textarea");　
        e5.classList.add('henseiName');
        //        e5.setAttribute('type', 'text');
        f.append(e5);　 //<br>
        f.append(document.createElement("br"));
        //ラベル「出撃で付く札」
        　
        e5 = document.createElement("label");
        e5.append(document.createTextNode("出撃札"));
        f.append(e5.cloneNode(true));
        //<br>
        //f.append(document.createElement("br"));
        e5 = document.createElement("select");
        //札のドロップダウンリスト
        e5.classList.add('lst_fudaList');
        e5.setAttribute('onchange', 'selectHenseiFuda()');
        f.append(e5.cloneNode(true));
        //<br>
        　
        f.append(document.createElement("br"));
        //ラベル「艦隊の種類」
        e5 = document.createElement("label");
        e5.append(document.createTextNode("編成部隊"));
        f.append(e5.cloneNode(true));
        //<br>
        //f.append(document.createElement("br"));
        //艦隊の種類のドロップダウンリスト
        e5 = document.createElement("select");
        e5.classList.add('lit_kantaiSize');
        e5.setAttribute('onchange', 'setkantaiSize()');
        e5 = makeSelectBox(e5, [
          ['通常艦隊', '#ffffff', '#000000'],
          ['水上打撃', '#ffffff', '#000000'],
          ['空母機動', '#ffffff', '#000000'],
          ['輸送護衛', '#ffffff', '#000000'],
          ['遊撃部隊', '#ffffff', '#000000']
        ]);
        f.append(e5.cloneNode(true));
        //<br>
        //f.append(document.createElement("br"));
        e5 = document.createElement("ul");
        e5.classList.add('kantaiHensei');　
        f.append(e5.cloneNode(true));
        e5 = document.createElement("details");
        e6 = document.createElement("summary");
        e6.append(document.createTextNode("編成条件"));　
        e5.appendChild(e6.cloneNode(true));
        e6 = document.createElement("textarea");
        e6.classList.add("txtr_kantaiCaution");
        e6.setAttribute('oninput', 'ChangeHenseiList();');
        e5.appendChild(e6.cloneNode(true));　
        f.append(e5.cloneNode(true));
        e5 = document.createElement("details");
        e6 = document.createElement("summary");
        e6.append(document.createTextNode("特効情報"));　
        e5.appendChild(e6.cloneNode(true));
        e6 = document.createElement("textarea");
        e6.classList.add("txtr_kantaitokkou");
        e6.setAttribute('oninput', 'ChangeTokkouList();');
        e5.appendChild(e6.cloneNode(true));　
        f.append(e5.cloneNode(true));
        e5 = document.createElement("details");
        e6 = document.createElement("summary");
        e6.append(document.createTextNode("外部連携"));　
        e5.appendChild(e6.cloneNode(true));
        e6 = document.createElement("label");
        e6.innerHTML = "デッキビルダー形式";
        e5.appendChild(e6.cloneNode(true));
        e6 = document.createElement("textarea");
        e6.classList.add("txtr_deckbuilder");
        e6.setAttribute('onfocus', "copyDeckText();this.select();");
        e5.appendChild(e6.cloneNode(true));
        f.append(e5.cloneNode(true));
        e4.appendChild(f.cloneNode(true));
        e3.appendChild(e4.cloneNode(true));
        e2.appendChild(e3.cloneNode(true));
        e1.appendChild(e2.cloneNode(true));
        sc.appendChild(e1.cloneNode(true));
        sc.getElementsByClassName('lst_fudaList')[0].selectedIndex = fudaIdx;
        sc.getElementsByClassName('lst_ListSort')[0].selectedIndex = sortIdx;
        //札情報をコピー
        sc.getElementsByClassName('lst_fudaList')[1].innerHTML = sc.closest('.sheetcontents').getElementsByClassName('splitLeft')[0].getElementsByClassName('lst_fudaList')[0].innerHTML;
        //艦隊サイズ分
        //艦隊情報の読み込み
        sc.getElementsByClassName('kantaiJouhou')[0].addEventListener('oninput', inputKanmusuData);
        sc.getElementsByClassName('kantaiJouhou')[0].dispatchEvent(new Event('oninput'));
        //ソート
        sc.getElementsByClassName('lst_ListSort')[0].addEventListener('onchange', ListSort);
        sc.getElementsByClassName('lst_ListSort')[0].dispatchEvent(new Event('onchange'));
        //編成の空のプリセットを必要数複製
        sc.getElementsByClassName('btn_addHensei')[0].addEventListener('onclick', addHensei);
        for (let i = 0; i < henseiArray.length - 1; i++) {
          sc.getElementsByClassName('btn_addHensei')[0].dispatchEvent(new Event('onclick'));
        }
        //編成データに合わせて編成
        a = sc.querySelectorAll('.kantaiHenseiAll');
        for (let i = 0; i < henseiArray.length; i++) {
          a[i].getElementsByClassName('henseiName')[0].value = henseiArray[i][0];
          a[i].getElementsByClassName('lst_fudaList')[0].selectedIndex = henseiArray[i][1];
          a[i].getElementsByClassName('lit_kantaiSize')[0].selectedIndex = henseiArray[i][2];　
          a[i].getElementsByClassName('lit_kantaiSize')[0].addEventListener('onchange', setkantaiSize);　
          a[i].getElementsByClassName('lit_kantaiSize')[0].dispatchEvent(new Event('onchange'));
          for (let k = 0; k < henseiArray[i][3].length; k++) {
            //なんで再定義しないとbが消滅するのか？
            b = a[i].querySelectorAll('.henseiItem');
            if (sc.getElementsByClassName('area')[0].getElementsByClassName(henseiArray[i][3][k]).length) {
              trySetHenseiItem(sc.getElementsByClassName('area')[0].getElementsByClassName(henseiArray[i][3][k])[0], b[k]);
            }
          }　
          a[i].getElementsByClassName('txtr_kantaiCaution')[0].value = henseiArray[i][4];
          a[i].getElementsByClassName('txtr_kantaitokkou')[0].value = henseiArray[i][5];
          checkHenseiAndTokkou(a[i]);
        }
      }
      //配列から指定したセレクトボックスの文字列と色を決定
      //セレクトダウンリストの中身を編集
      function makeSelectBox(e, fudaInfoArray) {
        let ec = document.createElement("option");
        for (let f of fudaInfoArray) {
          ec.innerHTML = f[0];
          ec.style.color = f[1];
          ec.style.backgroundColor = f[2];
          e.appendChild(ec.cloneNode(true));
        }
        return e;
      }
      //札選択時のfunction
      function selectFuda() {}
      //編成での札選択
      function selectHenseiFuda() {
        let sf;
        let kI;
        for (let i of event.target.parentNode.getElementsByClassName('henseiItem')) {
          sf = i.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0];
          if (event.target.closest('.splitRight').getElementsByClassName(i.classList[0]).length === 1) {
            //札が1こしかない場合左側と右側の札情報を上書き
            i.setAttribute('data-fudaidx', sf.selectedIndex);
            i.getElementsByClassName('shiparea')[0].innerText = sf.options[sf.selectedIndex].value;
            i.getElementsByClassName('shiparea')[0].style.color = sf.options[sf.selectedIndex].style.color;
            i.getElementsByClassName('shiparea')[0].style.backgroundColor = sf.options[sf.selectedIndex].style.backgroundColor;
            kI = event.target.closest('.sheetcontents').getElementsByClassName('area')[0].getElementsByClassName(i.classList[0])[0];
            kI.setAttribute('data-fudaidx', sf.selectedIndex);
            kI.getElementsByClassName('shiparea')[0].innerText = sf.options[sf.selectedIndex].value;
            kI.getElementsByClassName('shiparea')[0].style.color = sf.options[sf.selectedIndex].style.color;
            kI.getElementsByClassName('shiparea')[0].style.backgroundColor = sf.options[sf.selectedIndex].style.backgroundColor;
          } else {
            removeHenseiItem(i);
          }
        }
      }
      //編成から解除
      function removeHenseiItem(hI) {
        dealKantaiItemFuda(hI);
        hI.classList.remove(...hI.classList);
        hI.classList.add('ship0');
        hI.classList.add('henseiItem');
        hI.setAttribute('data-shipname', '編成なし');
        hI.setAttribute('data-shipid', '0');
        hI.setAttribute('data-shiplv', '-');
        hI.setAttribute('data-shipclass', '0');
        hI.setAttribute('data-shiptype', '0');
        hI.setAttribute('data-shipsort', '0');
        hI.setAttribute('data-shipsameid', '0');
        hI.setAttribute('data-fudaIdx', '-1');
        hI.setAttribute('title', '編成なし' + '\nLv' + '-');
        hI.getElementsByClassName('shipimg')[0].src = 'img/' + 0 + '.png';
        hI.getElementsByClassName('shipname')[0].innerHTML = '編成なし';
        hI.getElementsByClassName('shiplv')[0].innerHTML = 'Lv-';
        hI.getElementsByClassName('shiplv')[0].style.backgroundColor = "";
        hI.getElementsByClassName('shiparea')[0].innerHTML = '';
      }


      //艦隊ソートが札の場合にソートしなおす
      function resortbyfuda(){
        let kanSel = document.querySelectorAll('input[type="radio"][name="sheet_name"]:checked')[0].nextElementSibling.nextElementSibling.getElementsByClassName('lst_ListSort')[0];
        if (kanSel.selectedIndex === 4 || kanSel.selectedIndex === 5){
          kanSel.addEventListener('onchange', ListSort);　
          kanSel.dispatchEvent(new Event('onchange'));
        }
      }
      //保存
      async function saveCsvFile() {
        let opts = {
          suggestedName: '編成シート',
          types: [{
            description: 'Csv file',
            accept: {
              'text/csv': ['.csv']
            },
          }],
        };
        let khAllArray = document.querySelectorAll('input[type="radio"][name="sheet_name"]:checked')[0].nextElementSibling.nextElementSibling.getElementsByClassName('kantaiHenseiAll');
        let csvData = [
          ["編成名", "出撃札", "編成部隊", "編成1", "編成2", "編成3", "編成4", "編成5", "編成6", "編成7", "編成8", "編成9", "編成10", "編成11", "編成12", "編成条件", "特効情報"]
        ];
        makeCsvStr = "";
        for (let khAll of khAllArray) {
          hIArray = [];
          for (let hI of khAll.getElementsByClassName('henseiItem')) {
            hIArray.push(hI.querySelector('.shipname').textContent + (hI.querySelector('.shipname').textContent !== "編成なし" ? hI.querySelector('.shiplv').textContent : ""));
          }
          while (hIArray.length < 12) {
            hIArray.push("-");
          }
          csvData.push(
            ['"' + khAll.querySelector('.henseiName').value + '"', '"' + khAll.querySelector('.lst_fudaList').value + '"',
              khAll.querySelector('.lit_kantaiSize').value,
              hIArray[0], hIArray[1], hIArray[2], hIArray[3], hIArray[4], hIArray[5], hIArray[6], hIArray[7], hIArray[8], hIArray[9], hIArray[10], hIArray[11], '"' + khAll.querySelector('.txtr_kantaiCaution').value + '"', '"' + khAll.querySelector('.txtr_kantaitokkou').value + '"'
            ]);
        }
        const transpose = a => a[0].map((_, c) => a.map(r => r[c]));
        for (let csvRow of transpose(csvData)) {
          makeCsvStr += csvRow.join() + '\n';
        }
        let handle = await window.showSaveFilePicker(opts);
        let writable = await handle.createWritable();
        await writable.write(new Blob([new Uint8Array([0xEF, 0xBB, 0xBF]), makeCsvStr], {
          type: 'text/csv'
        }));
        await writable.close();
      }

      function makeCsvStr() {
        let khAllArray = document.querySelectorAll('input[type="radio"][name="sheet_name"]:checked')[0].nextElementSibling.nextElementSibling.getElementsByClassName('kantaiHenseiAll');
        let csvData = [
          ["編成名", "出撃札", "編成部隊", "編成1", "編成2", "編成3", "編成4", "編成5", "編成6", "編成7", "編成8", "編成9", "編成10", "編成11", "編成12", "編成条件", "特効情報"]
        ];
        makeCsvStr = "";
        for (let khAll of khAllArray) {
          hIArray = [];
          for (let hI of khAll.getElementsByClassName('henseiItem')) {
            hIArray.push(hI.querySelector('.shipname').textContent + (hI.querySelector('.shipname').textContent !== "編成なし" ? hI.querySelector('.shiplv').textContent : ""));
          }
          while (hIArray.length < 12) {
            hIArray.push("-");
          }
          csvData.push(
            ['"' + khAll.querySelector('.henseiName').value + '"', '"' + khAll.querySelector('.lst_fudaList').value + '"',
              khAll.querySelector('.lit_kantaiSize').value,
              hIArray[0], hIArray[1], hIArray[2], hIArray[3], hIArray[4], hIArray[5], hIArray[6], hIArray[7], hIArray[8], hIArray[9], hIArray[10], hIArray[11], '"' + khAll.querySelector('.txtr_kantaiCaution').value + '"', '"' + khAll.querySelector('.txtr_kantaitokkou').value + '"'
            ]);
        }
        const transpose = a => a[0].map((_, c) => a.map(r => r[c]));
        for (let csvRow of transpose(csvData)) {
          makeCsvStr += csvRow.join() + '\n';
        }
        return makeCsvStr;
      }
      //デッキビルダー形式のテキストをクリップボードにコピー
      function copyDeckText() {
        let kIArray = event.target.closest('.kantaiHenseiAll').getElementsByClassName('henseiItem');
        let returnText = '{"version":4,"f1":{';
        let f2text = '},"f2":{';
        let i = 1;
        if (kIArray.length === 7) {
          returnText = '{"version":4,"f1":{},"f2":{},"f3":{';
        }
        for (let kI of kIArray) {
          if (kI.getAttribute('data-shipid') !== "0") {
            returnText += '"s' + i + '":{"id":"' + kI.getAttribute('data-shipid') + '","lv":' + kI.getAttribute('data-shiplv') + ',"luck":-1,"items":{}},';
          }
          if (kIArray.length === 12 && i === 6) {
            i -= 6;
            returnText += f2text;
            f2text = '';
          }
          i++;
        }
        returnText += '}}';
        returnText = returnText.replace(/,}/g, '}');
        event.target.value = returnText;
      }
      //cssへの敗北
      function adjustLayout() {
        let wsY = window.scrollY;
        //スクロールする
        window.scroll(0, document.documentElement.offsetHeight);
        let lRect;
        let sRect;
        let clHeight = window.innerHeight-8;
        let selectedSheets = document.querySelectorAll('input[type="radio"][name="sheet_name"]:checked');
        if (selectedSheets.length !==0){
          let resizeSheet = selectedSheets[0].nextElementSibling.nextElementSibling;
          let resizeList = resizeSheet.getElementsByClassName('area')[0].querySelector('input[type="radio"]:checked').nextElementSibling.nextElementSibling;
          lRect = resizeList.getBoundingClientRect();
          sRect = resizeSheet.getBoundingClientRect();
          if (clHeight - sRect.top > 0){
            resizeSheet.style.height = clHeight - sRect.top;
          }
          if (clHeight - lRect.top > 0){
            resizeList.style.height = clHeight - lRect.top;
          }
        }
        //スクロールを戻す
        window.scroll(0, wsY);
      }
      //新規シートのタブを作成して選択する
      function MakeSheetTab(sheetName) {
        let f = document.createDocumentFragment();
        let e1 = document.createElement("input");
        e1.type = "radio";
        e1.name = "sheet_name";
        e1.classList.add('defaultHideRadios');
        e1.id = makeNewId('sheet', 1)[0];
        let e2 = document.createElement("label");
        e2.classList.add("sheet_tab");
        e2.setAttribute('onclick', 'adjustLayout()')
        e2.setAttribute('for', makeNewId('sheet', 1)[0]);
        e2.draggable = true;
        e2.setAttribute('ondragstart', 'sheetDragStart()');
        e2.setAttribute('ondragover', 'sheetDragOver()');
        e2.setAttribute('ondragleave', 'sheetDragLeave()');
        e2.setAttribute('ondrop', 'sheetOnDrop()');
        let e22 = document.createElement('input');
        e22.classList.add('sheet_name_label');
        e22.setAttribute('type', 'text');
        e22.value = sheetName;
        e22.draggable = false;
        e22.setAttribute('onclick', 'setTabFocus()');
        e2.append(e22);
        let e23 = document.createElement('button');
        e23.classList.add('closeButton');
        e23.setAttribute('onclick', 'deleteSheet()');
        e23.append(document.createTextNode(" × "));
        e2.append(e23);
        let e3 = document.createElement("div");
        e3.classList.add("sheetcontents");
        f.append(e1);
        f.append(e2);
        f.append(e3);
        document.getElementsByClassName('sheetselection')[0].insertBefore(f, document.getElementById('add_sheet'));
        document.getElementById(e1.id).checked = true; //作成したシートタブを選択する
      }
      //シートラベルのドラッグを開始
      function sheetDragStart() {
        dragObj = event.currentTarget;
      }
      //シートラベルの上をドラッグで移動
      function sheetDragOver() {
        event.preventDefault();
        if (dragObj.classList.contains('sheet_tab')) {
          let r = event.currentTarget.getBoundingClientRect();
          if ((event.clientX - r.left) < (event.currentTarget.clientWidth / 2)) {
            event.currentTarget.style.borderLeft = '2px solid blue';
            event.currentTarget.style.borderRight = '';
          } else {
            event.currentTarget.style.borderLeft = '';
            event.currentTarget.style.borderRight = '2px solid blue';
          }
        }
      }
      //シートラベルの上のドラッグから離脱
      function sheetDragLeave() {
        if (dragObj.classList.contains('sheet_tab')) {
          event.currentTarget.style.borderLeft = '';
          event.currentTarget.style.borderRight = '';
        }
      }
      //シートラベルの上にドロップ
      function sheetOnDrop() {
        event.preventDefault();
        if (event.currentTarget !== dragObj && dragObj.classList.contains('sheet_tab') && dragObj.getAttribute('for') !== 'add_sheet') {
          let r = event.currentTarget.getBoundingClientRect();
          let e1 = dragObj.previousSibling;
          let e2 = dragObj;
          let e3 = dragObj.nextSibling;
          if ((event.clientX - r.left) < (event.currentTarget.clientWidth / 2)) {
            event.currentTarget.parentNode.insertBefore(e1, event.currentTarget.previousSibling);
            event.currentTarget.parentNode.insertBefore(e2, event.currentTarget.previousSibling);
            event.currentTarget.parentNode.insertBefore(e3, event.currentTarget.previousSibling);
          } else {
            event.currentTarget.parentNode.insertBefore(e3, event.currentTarget.nextSibling.nextSibling);
            event.currentTarget.parentNode.insertBefore(e2, event.currentTarget.nextSibling.nextSibling);
            event.currentTarget.parentNode.insertBefore(e1, event.currentTarget.nextSibling.nextSibling);
          }
          event.currentTarget.style.borderLeft = '';
          event.currentTarget.style.borderRight = '';
        }
      }
      //編成セットのドラッグを開始
      function henseiDragStart() {
        dragObj = event.currentTarget;
      }
      //編成セットの上をドラッグで移動
      function henseiDragOver() {
        event.preventDefault();
        let r = event.currentTarget.getBoundingClientRect();
        if (dragObj.classList.contains('kantaiHenseiAll')) {
          if ((event.clientX - r.left) < (event.currentTarget.clientWidth / 2)) {
            event.currentTarget.style.borderLeft = '2px solid blue';
            event.currentTarget.style.borderRight = '';
          } else {
            event.currentTarget.style.borderLeft = '';
            event.currentTarget.style.borderRight = '2px solid blue';
          }
        }
      }
      //編成セットの上のドラッグから離脱
      function henseiDragLeave() {
        if (dragObj.classList.contains('kantaiHenseiAll')) {
          event.currentTarget.style.borderLeft = '';
          event.currentTarget.style.borderRight = '';
        }
      }
      //編成セットの上にドロップ
      function henseiOnDrop() {
        event.preventDefault();
        //編成アイテムをドロップしたとき     
        　　　　
        if (dragObj.classList.contains('henseiItem') && event.currentTarget.classList.contains('kantaiHenseiAll')) {
          let a = event.currentTarget.getElementsByClassName('kantaiHensei');
          let rTop = a[0].getBoundingClientRect();
          let rBottom = a[a.length - 1].getBoundingClientRect();
          if (Math.max((rTop.top - event.clientY), (event.clientY - rBottom.bottom)) > 30) {
            let shipInfoText = makeNewShip('0', ['0', '0', '編成なし', '0', '0', '0', '0', '0'], '-');
            shipInfoText.classList.remove('kantaiItem');
            shipInfoText.classList.add('henseiItem');
            shipInfoText.setAttribute('data-id', '0');
            shipInfoText.setAttribute('ondragstart', 'henseiItemDragStart()');
            shipInfoText.setAttribute('ondragover', 'henseiItemDragOver()');
            shipInfoText.setAttribute('ondragleave', 'henseiItemDragLeave()');
            shipInfoText.setAttribute('ondrop', 'henseiItemOnDrop()');
            dragObj.parentNode.insertBefore(shipInfoText, dragObj);
            dealKantaiItemFuda(dragObj);
            dragObj.remove();
            checkHenseiAndTokkou(shipInfoText); //編成と特効状態のチェック
            return;
          }
        }
        //編成アイテムを艦隊アイテムにドロップしたとき     
        　　　　
        if (dragObj.classList.contains('henseiItem') && event.currentTarget.classList.contains('kantaiItem')) {
          let fhIArray = dragObj.closest('.splitRight').getElementsByClassName(dragObj.classList[0]);
          let thIArray = event.currentTarget.closest('.sheetcontents').getElementsByClassName('splitRight')[0].getElementsByClassName(event.currentTarget.classList[0]);
          let hIArray;
          let fromCheckList;
          let tssiArray;
          let f = dragObj.cloneNode(true);
          let t = event.currentTarget.cloneNode(true);
          let fShip = f.classList[0];
          let tShip = t.classList[0];
          t.classList.remove('kantaiItem');
          t.classList.add('henseiItem');
          t.setAttribute('ondragstart', 'henseiItemDragStart()');
          t.setAttribute('ondragover', 'henseiItemDragOver()');
          t.setAttribute('ondragleave', 'henseiItemDragLeave()');
          t.setAttribute('ondrop', 'henseiItemOnDrop()');
          f.classList.add('judge');
          t.classList.add('judge');

          //札情報の解除
          event.currentTarget.setAttribute('data-fudaidx', -1);
          event.currentTarget.getElementsByClassName('shiparea')[0].innerHTML = "";
          event.currentTarget.getElementsByClassName('shiparea')[0].style.color = "";
          event.currentTarget.getElementsByClassName('shiparea')[0].style.backgroundColor = "";
          //編成なしを艦隊艦娘にドロップしたときはドロップされた艦娘の編成を全て解除する
          if (dragObj.getAttribute('data-fudaidx') == -1) {
            for (let thI of thIArray) {
              thI.parentNode.insertBefore(dragObj.cloneNode('true'), thI);
            }
            while (thIArray.length) {
              thIArray[0].remove();
            }
          } else {
          //編成艦娘を艦隊艦娘にドロップしたときは全編成で艦娘の入れ替えを挑戦する
            let dkI = dragObj.closest('.sheetcontents').getElementsByClassName('area')[0].getElementsByClassName(dragObj.classList[0])[0];
            dkI.setAttribute('data-fudaidx', -1);
            dkI.getElementsByClassName('shiparea')[0].innerHTML = "";
            dkI.getElementsByClassName('shiparea')[0].style.color = "";
            dkI.getElementsByClassName('shiparea')[0].style.backgroundColor = "";
          //とりあえず編成艦娘同士を入れ替える
            for (let thI of thIArray) {
              if (thI.parentNode.getElementsByClassName(dragObj.classList[0]).length === 0) {
                thI.parentNode.insertBefore(f.cloneNode(true), thI);
                thI.classList.add('del');
              }
            }
            for (let fhI of fhIArray) {
              if (fhI.parentNode.getElementsByClassName(event.currentTarget.classList[0]).length === 0) {
                fhI.parentNode.insertBefore(t.cloneNode(true), fhI);
                fhI.classList.add('del');
              }
            }
            let delItems = dragObj.closest('.splitRight').getElementsByClassName('del');
            while (delItems.length !== 0) {
              delItems[0].remove();
            }
            let judgeItems = event.currentTarget.closest('.sheetcontents').getElementsByClassName('splitRight')[0].getElementsByClassName('judge');
            while (judgeItems.length !== 0) {
              hIArray = Array.from(judgeItems[0].parentNode.querySelectorAll('.henseiItem'));
              tssiArray = judgeItems[0].getAttribute('data-shipsameid').split(',');
              if (hIArray.length === 12) {
                if (hIArray.indexOf(judgeItems[0]) < 6) {
                  fromCheckList = hIArray.slice(0, 6);
                } else {
                  fromCheckList = hIArray.slice(6);
                }
              } else {
                fromCheckList = hIArray;
              }
              for (let fhI of fromCheckList) {
                if (fhI !== judgeItems[0] && fhI.getAttribute('data-shipid') !== "0") {
                  for (let tssi of tssiArray) {
                    if (tssi == fhI.getAttribute('data-shipid')) {　　　
                      judgeItems[0].setAttribute('data-shipname', '編成なし');　　　
                      judgeItems[0].setAttribute('data-shipid', '0');　　　
                      judgeItems[0].setAttribute('data-shiplv', '-');　　　
                      judgeItems[0].setAttribute('data-shipclass', '0');　　　
                      judgeItems[0].setAttribute('data-shiptype', '0');　　　
                      judgeItems[0].setAttribute('data-shipsort', '0');　　　
                      judgeItems[0].setAttribute('data-shipsameid', '0');　　　
                      judgeItems[0].setAttribute('data-fudaIdx', '-1');　　　
                      judgeItems[0].setAttribute('title', '編成なし' + '\nLv' + '-');　　　
                      judgeItems[0].getElementsByClassName('shiplv')[0].innerHTML = '編成不可';　　　
                      judgeItems[0].getElementsByClassName('shiplv')[0].style.backgroundColor = "red";　　　
                      judgeItems[0].getElementsByClassName('shiparea')[0].innerHTML = '';
                      judgeItems[0].classList.replace(judgeItems[0].classList[0],'ship0');
                      break;
                    }
                  }
                }
              }
              //編成可能であれば
              if (!judgeItems[0].classList.contains('ship0') ) {
                jISelect = judgeItems[0].closest('.kantaiHenseiAll').getElementsByClassName("lst_fudaList")[0];
                //編成の札を設定
                judgeItems[0].setAttribute('data-fudaidx', jISelect.selectedIndex);
                judgeItems[0].getElementsByClassName('shiparea')[0].innerHTML = jISelect.value;
                judgeItems[0].getElementsByClassName('shiparea')[0].style.color = jISelect.options[jISelect.selectedIndex].style.color;
                judgeItems[0].getElementsByClassName('shiparea')[0].style.backgroundColor = jISelect.options[jISelect.selectedIndex].style.backgroundColor;
              }
              judgeItems[0].classList.remove('judge');
            }
            let fShipArray = event.currentTarget.closest('.sheetcontents').getElementsByClassName('splitRight')[0].getElementsByClassName(fShip);
            let tShipArray = event.currentTarget.closest('.sheetcontents').getElementsByClassName('splitRight')[0].getElementsByClassName(tShip);
            if (tShipArray.length != 0){
              event.currentTarget.setAttribute('data-fudaidx', tShipArray[0].getAttribute('data-fudaidx'));
              event.currentTarget.getElementsByClassName('shiparea')[0].innerHTML = tShipArray[0].getElementsByClassName('shiparea')[0].innerHTML;
              event.currentTarget.getElementsByClassName('shiparea')[0].style.color = tShipArray[0].getElementsByClassName('shiparea')[0].style.color;
              event.currentTarget.getElementsByClassName('shiparea')[0].style.backgroundColor = tShipArray[0].getElementsByClassName('shiparea')[0].style.backgroundColor;
            }
            if (fShipArray.length != 0){
              event.currentTarget.parentNode.getElementsByClassName(fShip)[0].setAttribute('data-fudaidx', fShipArray[0].getAttribute('data-fudaidx'));
              event.currentTarget.parentNode.getElementsByClassName(fShip)[0].getElementsByClassName('shiparea')[0].innerHTML = fShipArray[0].getElementsByClassName('shiparea')[0].innerHTML;
              event.currentTarget.parentNode.getElementsByClassName(fShip)[0].getElementsByClassName('shiparea')[0].style.color = fShipArray[0].getElementsByClassName('shiparea')[0].style.color;
              event.currentTarget.parentNode.getElementsByClassName(fShip)[0].getElementsByClassName('shiparea')[0].style.backgroundColor = fShipArray[0].getElementsByClassName('shiparea')[0].style.backgroundColor;
            }
          }
          //札ソートの場合ソートしなおす
          resortbyfuda();
        }
        //編成セットをドロップしたとき
        if (dragObj.classList.contains('kantaiHenseiAll')) {
          let r = event.currentTarget.getBoundingClientRect();
          if ((event.clientX - r.left) < (event.currentTarget.clientWidth / 2)) {
            event.currentTarget.parentNode.insertBefore(dragObj, event.currentTarget);
          } else {
            event.currentTarget.parentNode.insertBefore(dragObj, event.currentTarget.nextSibling);
          }
          event.currentTarget.style.borderLeft = '';
          event.currentTarget.style.borderRight = '';
        }
      }
      //編成艦娘のドラッグを開始
      function henseiItemDragStart() {
        dragObj = event.currentTarget;
        event.stopPropagation()
      }
      //編成艦娘の上をドラッグで移動
      function henseiItemDragOver() {
        event.preventDefault();
        //同一編成内での順序入れ替え
        if (dragObj.classList.contains('henseiItem') && dragObj.parentNode === event.currentTarget.parentNode) {
          let r = event.currentTarget.getBoundingClientRect();
          let dr = dragObj.getBoundingClientRect();
          if (r.left === dr.left) {
            if ((event.clientY - r.top) < (event.currentTarget.clientHeight / 2)) {
              event.currentTarget.style.borderBottom = '';
              event.currentTarget.style.borderTop = '2px solid blue';
            } else {
              event.currentTarget.style.borderBottom = '2px solid blue';
              event.currentTarget.style.borderTop = '';
            }
          }
        }
      }
      //編成艦娘の上のドラッグから離脱
      function henseiItemDragLeave() {
        //同一編成内での順序入れ替え
        if (dragObj.classList.contains('henseiItem') && dragObj.parentNode === event.currentTarget.parentNode) {
          event.currentTarget.style.borderBottom = '';
          event.currentTarget.style.borderTop = '';
        }
      }
      //編成艦娘の上にドロップ
      function henseiItemOnDrop() {
        event.preventDefault();
        //event.currentTarget !== dragObj &&
        if (dragObj.classList.contains('henseiItem')) {
          //同一編成内での順序入れ替え
          let r = event.currentTarget.getBoundingClientRect();
          let dr = dragObj.getBoundingClientRect();
          if (dragObj.parentNode === event.currentTarget.parentNode && r.left === dr.left) {
            if ((event.clientY - r.top) < (event.currentTarget.clientHeight / 2)) {
              //同型艦編成の確認が必要
              event.currentTarget.parentNode.insertBefore(dragObj, event.currentTarget);
            } else {
              //同型艦編成の確認が必要
              　　　
              event.currentTarget.parentNode.insertBefore(dragObj, event.currentTarget.nextSibling);
            }
            event.currentTarget.style.borderBottom = '';
            event.currentTarget.style.borderTop = '';
          } else {
            //編成済みの艦娘の入れ替えをトライ
            tryExchangeHenseiItem(dragObj, event.currentTarget);
          }
        }
        //艦隊リストから編成リストへドラッグオンドロップ
        if (dragObj.classList.contains('kantaiItem')) {
          //艦隊艦娘の編成へのセットをトライ
          trySetHenseiItem(dragObj, event.currentTarget);
        }
      }
      //艦隊艦娘のドラッグを開始
      function kantaiItemDragStart() {
        dragObj = event.currentTarget;
        //event.stopPropagation()
      }
      //艦隊艦娘の上をドラッグで移動
      function kantaiItemDragOver() {
        event.preventDefault();
      }
      //艦隊艦娘の上にドロップ
      function kantaiItemOnDrop() {
        event.preventDefault();
        if (dragObj.classList.contains('henseiItem')) {
          trySetkantaiItem(dragObj, event.currenTarget);
        }
      }
      //編成済みの艦娘の入れ替えをトライ
      function tryExchangeHenseiItem(fromItem, toItem) {
        let fromList = Array.from(fromItem.parentNode.querySelectorAll('.henseiItem'));
        let toList = Array.from(toItem.parentNode.querySelectorAll('.henseiItem'));
        let fromCheckList = fromList;
        let toCheckList = toList;
        //お互いの編成先に同一艦がいないことを確認
        for (let fhI of fromList) {
          if (fromItem !== fhI && toItem !== fhI && fhI.classList[0] === toItem.classList[0] && toItem.getAttribute('data-shipid') !== "0") {　　　
            return;
          }
        }
        for (let fhI of toList) {
          if (fromItem !== fhI && toItem !== fhI && fhI.classList[0] === fromItem.classList[0] && fromItem.getAttribute('data-shipid') !== "0") {　　　
            return;
          }
        }
        //お互いの比較対象となる編成艦娘のリストを作る
        if (fromList.length === 12) {
          if (fromList.indexOf(fromItem) < 6) {
            fromCheckList = fromList.slice(0, 6);
          } else {
            fromCheckList = fromList.slice(6);
          }
        }
        if (toList.length === 12) {
          if (toList.indexOf(toItem) < 6) {
            toCheckList = toList.slice(0, 6);
          } else {
            toCheckList = toList.slice(6);
          }
        }
        let fssiArray = fromItem.getAttribute('data-shipsameid').split(',');
        for (let thI of toCheckList) {
          if (thI !== toItem && thI.getAttribute('data-shipid') !== "0") {
            for (let fssi of fssiArray) {
              if (fssi == thI.getAttribute('data-shipid')) {　　　
                return;
              }
            }
          }
        }
        let tssiArray = toItem.getAttribute('data-shipsameid').split(',');
        for (let fhI of fromCheckList) {
          if (fhI !== fromItem && fhI.getAttribute('data-shipid') !== "0") {
            for (let tssi of tssiArray) {
              if (tssi == fhI.getAttribute('data-shipid')) {　　　
                return;
              }
            }
          }
        }
        //両編成の出撃札が異なり「編成なし」ではない編成艦娘が2隻以上編成されている
        let toFudaSelect = toItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0];
        let fromFudaSelect = fromItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0];
        if (fromItem.getAttribute('data-fudaidx') !== toItem.getAttribute('data-fudaidx') && fromItem.parentNode !== toItem.parentNode) {
          if (((fromItem.getAttribute('data-fudaidx') != -1 && fromItem.closest('.splitRight').getElementsByClassName(fromItem.classList[0]).length !== 1) || (toItem.getAttribute('data-fudaidx') != -1 && toItem.closest('.splitRight').getElementsByClassName(toItem.classList[0]).length !== 1)) && toFudaSelect.selectedIndex !== fromFudaSelect.selectedIndex) {
            return;
          }
        }
        //艦娘を交換する
        let fsa = fromItem.getElementsByClassName('shiparea')[0];
        let tsa = toItem.getElementsByClassName('shiparea')[0];
        //札変更の処理をあらかじめ
        if (fromItem.getAttribute('data-fudaidx') != -1) {
          let kfromItem = fromItem.closest('.sheetcontents').getElementsByClassName('area')[0].getElementsByClassName(fromItem.classList[0])[0];
          let kfsa = kfromItem.getElementsByClassName('shiparea')[0];
          fromItem.setAttribute('data-fudaidx', toFudaSelect.selectedIndex);
          fsa.innerHTML = toFudaSelect.value;
          fsa.style.backgroundColor = toFudaSelect.options[toFudaSelect.selectedIndex].style.backgroundColor;
          fsa.style.color = toFudaSelect.options[toFudaSelect.selectedIndex].style.color;
          kfromItem.setAttribute('data-fudaidx', toFudaSelect.selectedIndex);
          kfsa.innerHTML = toFudaSelect.value;
          kfsa.style.backgroundColor = toFudaSelect.options[toFudaSelect.selectedIndex].style.backgroundColor;
          kfsa.style.color = toFudaSelect.options[toFudaSelect.selectedIndex].style.color;
        }
        if (toItem.getAttribute('data-fudaidx') != -1) {
          let ktoItem = toItem.closest('.sheetcontents').getElementsByClassName('area')[0].getElementsByClassName(toItem.classList[0])[0];
          let ktsa = ktoItem.getElementsByClassName('shiparea')[0];
          toItem.setAttribute('data-fudaidx', fromFudaSelect.selectedIndex);
          tsa.innerHTML = fromFudaSelect.value;
          tsa.style.backgroundColor = fromFudaSelect.options[fromFudaSelect.selectedIndex].style.backgroundColor;
          tsa.style.color = fromFudaSelect.options[fromFudaSelect.selectedIndex].style.color;
          ktoItem.setAttribute('data-fudaidx', fromFudaSelect.selectedIndex);
          ktsa.innerHTML = fromFudaSelect.value;
          ktsa.style.backgroundColor = fromFudaSelect.options[fromFudaSelect.selectedIndex].style.backgroundColor;
          ktsa.style.color = fromFudaSelect.options[fromFudaSelect.selectedIndex].style.color;
        }
        fromItem.parentNode.insertBefore(toItem.cloneNode(true), fromItem.nextSibling);
        toItem.parentNode.insertBefore(fromItem.cloneNode(true), toItem.nextSibling);
        toItem.remove();
        fromItem.remove();
        //札ソートの場合ソートしなおす
        resortbyfuda();
      }
      //艦隊艦娘の編成へのセットをトライ
      function trySetHenseiItem(fromItem, toItem) {
        let fromFuda = fromItem.getAttribute('data-fudaidx');
        let toFuda = toItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0].selectedIndex;
        //異なる札同士ではなく編成制限にも引っかからない場合
        if ((fromFuda == toFuda || fromFuda == -1) && checkRestrictHensei(fromItem, toItem)) {
          dealKantaiItemFuda(toItem); //該当の編成艦娘を消す場合の艦隊艦娘の処理を実行
          fromItem.setAttribute('data-fudaidx', toFuda);
          fromItem.getElementsByClassName('shiparea')[0].innerText = toItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0].value;
          fromItem.getElementsByClassName('shiparea')[0].style = toItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0].style;　
          let te = toItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0].selectedIndex;
          fromItem.getElementsByClassName('shiparea')[0].style = toItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0].options[te].style;
          fromItem.getElementsByClassName('shiparea')[0].style.color = toItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0].options[te].style.color;
          fromItem.getElementsByClassName('shiparea')[0].style.backgroundColor = toItem.closest('.kantaiHenseiAll').getElementsByClassName('lst_fudaList')[0].options[te].style.backgroundColor;
          let addItem = fromItem.cloneNode(true);
          addItem.classList.remove('kantaiItem');
          addItem.classList.add('henseiItem');
          addItem.setAttribute('ondragstart', 'henseiItemDragStart()');
          addItem.setAttribute('ondragover', 'henseiItemDragOver()');
          addItem.setAttribute('ondragleave', 'henseiItemDragLeave()');
          addItem.setAttribute('ondrop', 'henseiItemOnDrop()');
          toItem.parentNode.insertBefore(addItem, toItem);
          toItem.remove();
          checkHenseiAndTokkou(addItem); //編成と特効状態のチェック
          //札ソートの場合ソートしなおす
          resortbyfuda();
        }
      }
      //該当の編成艦娘を消す場合の艦隊艦娘の処理を実行
      function dealKantaiItemFuda(toItem) {
        toItem.classList.remove('henseiItem');
        let strshipId = toItem.classList[0];
        if (toItem.closest('.splitRight').getElementsByClassName(strshipId).length === 1 && strshipId !== 'ship0') {
          toItem.closest('.sheetcontents').getElementsByClassName('area')[0].getElementsByClassName(strshipId)[0].setAttribute('data-fudaidx', -1);
          toItem.closest('.sheetcontents').getElementsByClassName('area')[0].getElementsByClassName(strshipId)[0].getElementsByClassName('shiparea')[0].innerText = "";
        }
        toItem.classList.add('henseiItem');
      }
      //同一艦、同名艦の編成制限に引っかからないかチェック：trueで編成可能
      function checkRestrictHensei(fromItem, toItem) {
        let judgeResult = true;
        let checkIdArray = fromItem.getAttribute('data-shipsameid').split(',');
        let allHenseiArray = Array.from(toItem.closest('.kantaiHensei').querySelectorAll('.henseiItem'));
        let fromShipIds = fromItem.cloneNode(true);
        let fromShipId = fromShipIds.classList[0];
        let checkHenseiArray = allHenseiArray;
        //同じ艦隊ID艦を編成しようとしている
        for (let a of checkHenseiArray) {
          if (a !== toItem && a.classList.contains(fromShipId)) {
            return false;
          }
        }
        //連合艦隊の場合
        if (allHenseiArray.length === 12) {
          checkHenseiArray = allHenseiArray.slice(0, 6);
          if (checkHenseiArray.includes(toItem) !== true) {
            checkHenseiArray = allHenseiArray.slice(6);
          }
        }
        for (let a of checkHenseiArray) {
          if (a !== toItem) {
            b = a.getAttribute('data-shipid');
            for (c of checkIdArray) {
              if (c === b) {
                return false;
              }
            }
          }
        }
        return judgeResult;
      }
      //編成済みの艦娘の入れ替えをトライ
      function trySetkantaiItem(fromItem, toItem) {
      }
      //特効艦のテキストが変更
      function ChangeTokkouList() {
        ChangeTokkouDisp(event.target);
      }
      //特効艦のテキストを分析して表示を変更
      function ChangeTokkouDisp(et) {
            let msgAry;
        for (hI of et.closest('.KantaiHenseiAll').getElementsByClassName('henseiItem')) {
          hI.style.border = "";
          hI.style.backgroundColor = "";
          for (ln of et.value.split('\n')) {
            msgAry = ln.split(/\s*=\s*/);
            if (hI.getAttribute("data-shipname") === msgAry[0]) {
              hI.style.backgroundColor = "#ffa500";
            }
          }
        }
      }
      //編成制約のテキストが変更
      function ChangeHenseiList() {
        ChangeHenseiDisp(event.target);
      }
      //編成制約のテキストが変更
      function ChangeHenseiDisp(et) {
        let judgeHensei = true;
        let sahenV = 0;
        let uhenV = 0;
        for (ln of et.value.split('\n')) {
          sahenV = 0;
          uhenV = TextLastNum(ln);
          for (k of ln.split(/\s*[\+=<>]+\s*/)) {
            for (hI of et.closest('.KantaiHenseiAll').getElementsByClassName('henseiItem')) {
              if (hI.getAttribute("data-shipname") === k || hI.getAttribute("data-shipclass") === k) {
                sahenV++
              }
            }
          }
          if ((sahenV - uhenV) !== 0) {
            judgeHensei = false;
          }
        }
        if (judgeHensei) {
          et.closest('.KantaiHenseiAll').style.backgroundColor = "";
        } else {
          et.closest('.KantaiHenseiAll').style.backgroundColor = "#FF88FF";
        }
      }

      function TextLastNum(txt) {
        let regexP = /.*?(\d+)$/mg;
        let match = regexP.exec(txt);
        if (match) {
          return `${match[1]}`;
        } else {
          return 0;
        }
      }
      //シートを削除する
      function deleteSheet() {
        if (event.target.parentNode.previousSibling.checked === true) {
          let s_target = event.target.closest('.sheetselection').querySelectorAll('input');
        }
        event.target.parentNode.nextSibling.remove();
        event.target.parentNode.previousSibling.remove();
        event.target.parentNode.remove();
      }
      //札のテキストと色の初期設定
      function newfudaInfoArray() {
        let r = [];
        let fName;
        for (let i = 1; i <= maxfudacount; i++) {
          fName = defaultFudaName + i;
          r.push([fName, defaultFudaTextColor, defaultFudaBackColor]);
        }
        r=[
          ["南西方面" ,"rgb(195, 233, 150)", "rgb(51, 84, 22)"],
          ["第三十一" ,"rgb(240, 184, 208)", "rgb(133, 17, 60)"],
          ["連合艦隊" ,"rgb(113, 181, 235)", "rgb(17, 57, 89)"],
          ["輸送部隊" ,"rgb(219, 195, 101)", "rgb(53, 43, 14)"],
          ["第十六戦隊" ,"rgb(213, 218, 246)", "rgb(60, 68, 152)"],
          ["シマ船団" ,"rgb(179, 179, 179)", "rgb(41, 40, 35)"],
          ["遊撃部隊" ,"rgb(186, 168, 81)", "rgb(40, 33, 2)"],
          ["決戦艦隊" ,"rgb(62, 173, 53)", "rgb(8, 39, 12)"],
          ["札9" ,"rgb(0, 0, 0)", "rgb(255, 255, 255)"],
          ["札10" ,"rgb(0, 0, 0)", "rgb(255, 255, 255)"]
          ];
        return r;
      }
      //編成情報の初期設定
      function newhenseiArray() {
        //札1、通常艦隊、編成なし
        return [defaultHenseiName, 0, 0, ['ship0', 'ship0', 'ship0', 'ship0', 'ship0', 'ship0'], "", ""];
      }
      //新しいIDを指定した個数生成する
      function makeNewId(txt, arraysize) {
        let SheetId = [];
        let i = 0;
        let n = 0;
        do {
          i++;
          if (document.getElementById(txt + i) === null) {
            SheetId.push(txt + i);
            n++;
          }
        } while (n < arraysize)
        return SheetId;
      }
      //艦隊の並べ替え
      function ListSort() {
        let updown = 1;
        let sortkey = '';
        switch (event.target.selectedIndex) {
        case 0:
          updown = -1
        case 1:
          sortkey = "data-shiplv"
          break;
        case 2:
          updown = -1
        case 3:
          sortkey = "data-shipsort"
          break;
        case 4:
          updown = -1
        case 5:
          sortkey = "data-fudaidx"
        }
        //艦隊の艦娘を並べ替え
        for (tmpListObj of event.target.closest('.splitLeft').getElementsByClassName("kantaiList")) {
          switch (sortkey) {
          case "data-shiplv":
            compareLv(tmpListObj, "data-fudaidx", -1);
            compareLv(tmpListObj, "data-shipsort", 1);
            break;
          case "data-shipsort":
            compareLv(tmpListObj, "data-fudaidx", -1);
            compareLv(tmpListObj, "data-shiplv", -1);
            break;
          case "data-fudaidx":
            compareLv(tmpListObj, "data-shiplv", -1);
            compareLv(tmpListObj, "data-shipsort", 1);
          }
          compareLv(tmpListObj, sortkey, updown);
        }
      }
      //シートにフォーカスをあてる
      function setTabFocus() {
        event.target.parentNode.previousElementSibling.checked = true;
      }
      //編成のサイズを設定
      function setkantaiSize() {
        let idx = event.target.selectedIndex;
        let obj = event.target.closest('.kantaiHenseiAll').getElementsByClassName("kantaiHensei")[0];
        let shipInfoText = makeNewShip('0', ['0', '0', '編成なし', '0', '0', '0', '0', '0'], '-');
        shipInfoText.classList.remove('kantaiItem');
        shipInfoText.classList.add('henseiItem');
        shipInfoText.setAttribute('data-id', '0');
        shipInfoText.setAttribute('ondragstart', 'henseiItemDragStart()');
        shipInfoText.setAttribute('ondragover', 'henseiItemDragOver()');
        shipInfoText.setAttribute('ondragleave', 'henseiItemDragLeave()');
        shipInfoText.setAttribute('ondrop', 'henseiItemOnDrop()');
        //通常艦隊と遊撃部隊は1列、その他は2列で表示
        if (idx == 0 || idx == 4) {
          obj.style.setProperty("column-count", 1);
        } else {
          obj.style.setProperty("column-count", 2);
        }
        //不足枠を追加 
        while (obj.children.length < [6, 12, 12, 12, 7][idx]) {
          obj.appendChild(shipInfoText.cloneNode(true));
        }
        //過剰枠を削除
        while (obj.children.length > [6, 12, 12, 12, 7][idx]) {
          dealKantaiItemFuda(obj.lastChild); //該当の編成艦娘を消す場合の艦隊艦娘の処理を実行
          obj.removeChild(obj.lastChild);
        }
        checkHenseiAndTokkou(obj); //編成と特効状態のチェック
      }
      //新規編成セットを追加する
      function addHensei() {
        let obj = event.target.closest('.kantaiHenseiAll');
        let obj2 = obj.closest('tr');
        let idx = 0;
        let memoidx;
        for (let o of obj2.getElementsByClassName('kantaiHenseiAll')) {
          idx++;
          if (o === obj) {
            memoidx = idx;
          }
        }
        let obj3 = obj2.insertCell(memoidx);
        obj3.outerHTML = obj.outerHTML;
        obj.closest('tr').getElementsByClassName('kantaiHenseiAll')[memoidx].getElementsByClassName('henseiName')[0].value = obj.getElementsByClassName('henseiName')[0].value;
        obj.closest('tr').getElementsByClassName('kantaiHenseiAll')[memoidx].getElementsByClassName('txtr_kantaiCaution')[0].value = obj.getElementsByClassName('txtr_kantaiCaution')[0].value;
        obj.closest('tr').getElementsByClassName('kantaiHenseiAll')[memoidx].getElementsByClassName('txtr_kantaitokkou')[0].value = obj.getElementsByClassName('txtr_kantaitokkou')[0].value;
        obj.closest('tr').getElementsByClassName('kantaiHenseiAll')[memoidx].getElementsByClassName('lit_kantaiSize')[0].selectedIndex = obj.getElementsByClassName('lit_kantaiSize')[0].selectedIndex;
        obj.closest('tr').getElementsByClassName('kantaiHenseiAll')[memoidx].getElementsByClassName('lst_fudaList')[0].selectedIndex = obj.getElementsByClassName('lst_fudaList')[0].selectedIndex;
      }
      //編成セットを削除する
      function removeHensei() {
        let obj = event.target.closest('.kantaiHenseiAll');
        let obj2 = obj.closest('tr');
        let idx = 0;
        let memoidx;
        for (let o of obj2.getElementsByClassName('kantaiHenseiAll')) {
          if (o === obj) {
            memoidx = idx;
          }
          idx++;
        }
        if (idx !== 1) {
          for (let i of obj2.getElementsByClassName('kantaiHenseiAll')[memoidx].getElementsByClassName('henseiItem')) {
            dealKantaiItemFuda(i); //該当の編成艦娘を消す場合の艦隊艦娘の処理を実行
          }
          obj2.deleteCell(memoidx);
        } else {
          alert('編成が作れなくなるので消しません');
        }
      }
    </script>
  </head>
  <body>

    <div class = "information">
      <details open ontoggle = 'adjustLayout()'>
        <summary>このサイトについて</summary>
            <details style="padding-left:1em;" ontoggle = 'adjustLayout()'>
            <summary>使い方</summary>
            <details style="padding-left:1em;" open ontoggle = 'adjustLayout()'>
              <summary>初期設定</summary>
<div style ="font-size:0.8em;">
                １．シートの作成<br>
                　　ツール行の下の「＋」をクリック<br>
                ２．札のテキストと色の設定<br>
　　「出撃札編集」をクリックで編集ダイアログを開き、終わったら「設定」をクリック<br>
                ３．艦隊情報の入力<br>
　　「艦隊情報入力」をクリックで入力ダイアログを開く。<br>
　　艦隊の置き換えを選択。テキストエリアに艦隊分析形式の艦隊データテキストを入力し、「艦隊を設定」をクリック<br>
　　艦隊分析形式の艦隊データテキストの取得方法については各自で調べて下さい<br>                  
　　七四式だと編成情報右クリックで簡単に取得できます<br>
</div>
<img src="desc/図1.png" ><br>
             </details>                   
            <details style="padding-left:1em;" open ontoggle = 'adjustLayout()'>
              <summary>基本操作</summary>
<div style ="font-size:0.8em;">
                編成セットを必要分追加し、出撃札と編成部隊の種類(通常、連合等)を選択<br>
                艦娘をドラッグ＆ドロップで編成に追加すると札情報が追加されます<br>
並べ替えや編成解除もドラッグ＆ドロップで対応<br>
上部ツール欄でページの保存、編成のCSV出力、表示形式の切り替えが可能<br>
        

<img src="desc/図2.png" ><br>
      </div>
             </details>                   
            <details style="padding-left:1em;" open ontoggle = 'adjustLayout()'>
              <summary>その他機能</summary>
<div style ="font-size:0.8em;">

            <details style="padding-left:1em;" open ontoggle = 'adjustLayout()'>
              <summary style ="font-size:1.25em;">編成単位の機能</summary>
<div>
各編成で個別に割り当てられた機能について<br>
・「編成条件」のテキストエリアに図のような式を入れると、全ての式を満たさない限り編成の背景色が変化する<br>
・「特効情報」のテキストエリアに図のように艦娘名を入れると編成された艦娘の背景色が変化する<br>
・「外部連携」のテキストエリアをクリックすると編成の通りのデッキビルダー形式のテキストを生成する<br>
<img src="desc/図3.png" ><br>

</div>
             </details>      

                  <details style="padding-left:1em;" open ontoggle = 'adjustLayout()'>
              <summary style ="font-size:1.25em;">別シートの艦隊によるシート内編成の再現</summary>
<div>
シート内の全編成を別のシートの艦隊を用い(札の状態も考慮する)可能な限り再現した新規シートを作成する<br>
艦娘の割り当ては右側の編成から優先的に行い、改装段階も含めた同じ艦の中から同じ札が付いた艦娘とレベルが高い艦娘を優先して編成する<br>
編成ができなかった箇所には「編成可能艦なし」と記載のある艦娘が編成されるが、ページ内の扱いは「編成なし」と同じとなる<br>

<img src="desc/図4.png" ><br>
</div>
             </details>      


</div>
             </details>      
            
            </details>
              
            <details style="padding-left:1em;" ontoggle = 'adjustLayout()'>
              <summary>更新履歴</summary>
                <div style ="font-size:0.8em;">2022/05/23 とりあえずだいたいそれっぽく動いたものを公開<br></div>
            </details>
            <details style="padding-left:1em;" ontoggle = 'adjustLayout()'>
              <summary>メモ</summary>
<div style ="font-size:0.8em;">
・シートのデータを公開可能な共有リンク生成(firebase？)<br>
・セーブはオート化？<br>
・ページエレメントの生成はテンプレートファイルから読み込み？<br>
・マウスオーバー時のカーソルの変更<br>
・マウスオーバー時の艦娘情報の充実化<br>
・リファクタリング/例外処理/ファイル分割/命名規則/cssの修正<br>
</div>
            </details>
          <div style="padding-left:1em;font-size:0.7em;">このサイトを用いることで発生したいかなる問題についても責任を負いかねますので、それに同意できる方のみご利用ください。<br>
          当サイトで用いられている画像は著作権法に基づき引用しております。権利者様からの画像等の削除の依頼等には速やかに対処いたします。
          <a href="https://twitter.com/waiwaiworld573">連絡先(twitter)</a><br><br></div>
      </details>
    </div>
    <div class = "tools">
              <label>　ツール　</label>
              <input type = 'button' value = 'セーブ' onclick = 'MakeAllSaveData();'>
              <input type = 'button' value = 'シートをcsvで出力' onclick = 'saveCsvFile();'>
              <select onchange = "changeStyleSheet();">
                <option>表示形式：通常</option>
                <option>表示形式：省スペース</option>
              </select>
    </div>
    <div class = "maincontents">
      <div class = "sheetselection">
        <input type = "radio" class = "defaultHideRadios" name = "sheet_name" id = "add_sheet" onclick="MakeNewSheet();"/>
        <label class = "sheet_tab" for = "add_sheet">＋</label>
        <div class = "sheetcontents"></div>
      </div>
    </div>
  </body>
</html>